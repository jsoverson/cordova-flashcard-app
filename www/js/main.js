(function(){var t,e,n;(function(i){function r(t,e){return b.call(t,e)}function o(t,e){var n,i,r,o,s,a,u,c,l,h,d=e&&e.split("/"),f=w.map,p=f&&f["*"]||{};if(t&&"."===t.charAt(0))if(e){for(d=d.slice(0,d.length-1),t=d.concat(t.split("/")),c=0;t.length>c;c+=1)if(h=t[c],"."===h)t.splice(c,1),c-=1;else if(".."===h){if(1===c&&(".."===t[2]||".."===t[0]))break;c>0&&(t.splice(c-1,2),c-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((d||p)&&f){for(n=t.split("/"),c=n.length;c>0;c-=1){if(i=n.slice(0,c).join("/"),d)for(l=d.length;l>0;l-=1)if(r=f[d.slice(0,l).join("/")],r&&(r=r[i])){o=r,s=c;break}if(o)break;!a&&p&&p[i]&&(a=p[i],u=c)}!o&&a&&(o=a,s=u),o&&(n.splice(0,s,o),t=n.join("/"))}return t}function s(t,e){return function(){return f.apply(i,x.call(arguments,0).concat([t,e]))}}function a(t){return function(e){return o(e,t)}}function u(t){return function(e){g[t]=e}}function c(t){if(r(v,t)){var e=v[t];delete v[t],y[t]=!0,d.apply(i,e)}if(!r(g,t)&&!r(y,t))throw Error("No "+t);return g[t]}function l(t){var e,n=t?t.indexOf("!"):-1;return n>-1&&(e=t.substring(0,n),t=t.substring(n+1,t.length)),[e,t]}function h(t){return function(){return w&&w.config&&w.config[t]||{}}}var d,f,p,m,g={},v={},w={},y={},b=Object.prototype.hasOwnProperty,x=[].slice;p=function(t,e){var n,i=l(t),r=i[0];return t=i[1],r&&(r=o(r,e),n=c(r)),r?t=n&&n.normalize?n.normalize(t,a(e)):o(t,e):(t=o(t,e),i=l(t),r=i[0],t=i[1],r&&(n=c(r))),{f:r?r+"!"+t:t,n:t,pr:r,p:n}},m={require:function(t){return s(t)},exports:function(t){var e=g[t];return e!==void 0?e:g[t]={}},module:function(t){return{id:t,uri:"",exports:g[t],config:h(t)}}},d=function(t,e,n,o){var a,l,h,d,f,w,b=[];if(o=o||t,"function"==typeof n){for(e=!e.length&&n.length?["require","exports","module"]:e,f=0;e.length>f;f+=1)if(d=p(e[f],o),l=d.f,"require"===l)b[f]=m.require(t);else if("exports"===l)b[f]=m.exports(t),w=!0;else if("module"===l)a=b[f]=m.module(t);else if(r(g,l)||r(v,l)||r(y,l))b[f]=c(l);else{if(!d.p)throw Error(t+" missing "+l);d.p.load(d.n,s(o,!0),u(l),{}),b[f]=g[l]}h=n.apply(g[t],b),t&&(a&&a.exports!==i&&a.exports!==g[t]?g[t]=a.exports:h===i&&w||(g[t]=h))}else t&&(g[t]=n)},t=e=f=function(t,e,n,r,o){return"string"==typeof t?m[t]?m[t](e):c(p(t,e).f):(t.splice||(w=t,e.splice?(t=e,e=n,n=null):t=i),e=e||function(){},"function"==typeof n&&(n=r,r=o),r?d(i,t,e,n):setTimeout(function(){d(i,t,e,n)},15),f)},f.config=function(t){return w=t,f},n=function(t,e,n){e.splice||(n=e,e=[]),r(g,t)||r(v,t)||(v[t]=[t,e,n])},n.amd={jQuery:!0}})(),n("almond",function(){}),function(){function t(e,n,i){if(e===n)return 0!==e||1/e==1/n;if(null==e||null==n)return e===n;if(e._chain&&(e=e._wrapped),n._chain&&(n=n._wrapped),e.isEqual&&E.isFunction(e.isEqual))return e.isEqual(n);if(n.isEqual&&E.isFunction(n.isEqual))return n.isEqual(e);var r=c.call(e);if(r!=c.call(n))return!1;switch(r){case"[object String]":return e==n+"";case"[object Number]":return e!=+e?n!=+n:0==e?1/e==1/n:e==+n;case"[object Date]":case"[object Boolean]":return+e==+n;case"[object RegExp]":return e.source==n.source&&e.global==n.global&&e.multiline==n.multiline&&e.ignoreCase==n.ignoreCase}if("object"!=typeof e||"object"!=typeof n)return!1;for(var o=i.length;o--;)if(i[o]==e)return!0;i.push(e);var s=0,a=!0;if("[object Array]"==r){if(s=e.length,a=s==n.length)for(;s--&&(a=s in e==s in n&&t(e[s],n[s],i)););}else{if("constructor"in e!="constructor"in n||e.constructor!=n.constructor)return!1;for(var u in e)if(E.has(e,u)&&(s++,!(a=E.has(n,u)&&t(e[u],n[u],i))))break;if(a){for(u in n)if(E.has(n,u)&&!s--)break;a=!s}}return i.pop(),a}var e=this,n=e._,i={},r=Array.prototype,o=Object.prototype,s=Function.prototype,a=r.slice,u=r.unshift,c=o.toString,l=o.hasOwnProperty,h=r.forEach,d=r.map,f=r.reduce,p=r.reduceRight,m=r.filter,g=r.every,v=r.some,w=r.indexOf,y=r.lastIndexOf,b=Array.isArray,x=Object.keys,_=s.bind,E=function(t){return new O(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=E),exports._=E):e._=E,E.VERSION="1.3.3";var C=E.each=E.forEach=function(t,e,n){if(null!=t)if(h&&t.forEach===h)t.forEach(e,n);else if(t.length===+t.length){for(var r=0,o=t.length;o>r;r++)if(r in t&&e.call(n,t[r],r,t)===i)return}else for(var s in t)if(E.has(t,s)&&e.call(n,t[s],s,t)===i)return};E.map=E.collect=function(t,e,n){var i=[];return null==t?i:d&&t.map===d?t.map(e,n):(C(t,function(t,r,o){i[i.length]=e.call(n,t,r,o)}),t.length===+t.length&&(i.length=t.length),i)},E.reduce=E.foldl=E.inject=function(t,e,n,i){var r=arguments.length>2;if(null==t&&(t=[]),f&&t.reduce===f)return i&&(e=E.bind(e,i)),r?t.reduce(e,n):t.reduce(e);if(C(t,function(t,o,s){r?n=e.call(i,n,t,o,s):(n=t,r=!0)}),!r)throw new TypeError("Reduce of empty array with no initial value");return n},E.reduceRight=E.foldr=function(t,e,n,i){var r=arguments.length>2;if(null==t&&(t=[]),p&&t.reduceRight===p)return i&&(e=E.bind(e,i)),r?t.reduceRight(e,n):t.reduceRight(e);var o=E.toArray(t).reverse();return i&&!r&&(e=E.bind(e,i)),r?E.reduce(o,e,n,i):E.reduce(o,e)},E.find=E.detect=function(t,e,n){var i;return k(t,function(t,r,o){return e.call(n,t,r,o)?(i=t,!0):void 0}),i},E.filter=E.select=function(t,e,n){var i=[];return null==t?i:m&&t.filter===m?t.filter(e,n):(C(t,function(t,r,o){e.call(n,t,r,o)&&(i[i.length]=t)}),i)},E.reject=function(t,e,n){var i=[];return null==t?i:(C(t,function(t,r,o){e.call(n,t,r,o)||(i[i.length]=t)}),i)},E.every=E.all=function(t,e,n){var r=!0;return null==t?r:g&&t.every===g?t.every(e,n):(C(t,function(t,o,s){return(r=r&&e.call(n,t,o,s))?void 0:i}),!!r)};var k=E.some=E.any=function(t,e,n){e||(e=E.identity);var r=!1;return null==t?r:v&&t.some===v?t.some(e,n):(C(t,function(t,o,s){return r||(r=e.call(n,t,o,s))?i:void 0}),!!r)};E.include=E.contains=function(t,e){var n=!1;return null==t?n:w&&t.indexOf===w?-1!=t.indexOf(e):n=k(t,function(t){return t===e})},E.invoke=function(t,e){var n=a.call(arguments,2);return E.map(t,function(t){return(E.isFunction(e)?e||t:t[e]).apply(t,n)})},E.pluck=function(t,e){return E.map(t,function(t){return t[e]})},E.max=function(t,e,n){if(!e&&E.isArray(t)&&t[0]===+t[0])return Math.max.apply(Math,t);if(!e&&E.isEmpty(t))return-1/0;var i={computed:-1/0};return C(t,function(t,r,o){var s=e?e.call(n,t,r,o):t;s>=i.computed&&(i={value:t,computed:s})}),i.value},E.min=function(t,e,n){if(!e&&E.isArray(t)&&t[0]===+t[0])return Math.min.apply(Math,t);if(!e&&E.isEmpty(t))return 1/0;var i={computed:1/0};return C(t,function(t,r,o){var s=e?e.call(n,t,r,o):t;i.computed>s&&(i={value:t,computed:s})}),i.value},E.shuffle=function(t){var e,n=[];return C(t,function(t,i){e=Math.floor(Math.random()*(i+1)),n[i]=n[e],n[e]=t}),n},E.sortBy=function(t,e,n){var i=E.isFunction(e)?e:function(t){return t[e]};return E.pluck(E.map(t,function(t,e,r){return{value:t,criteria:i.call(n,t,e,r)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;return void 0===n?1:void 0===i?-1:i>n?-1:n>i?1:0}),"value")},E.groupBy=function(t,e){var n={},i=E.isFunction(e)?e:function(t){return t[e]};return C(t,function(t,e){var r=i(t,e);(n[r]||(n[r]=[])).push(t)}),n},E.sortedIndex=function(t,e,n){n||(n=E.identity);for(var i=0,r=t.length;r>i;){var o=i+r>>1;n(t[o])<n(e)?i=o+1:r=o}return i},E.toArray=function(t){return t?E.isArray(t)?a.call(t):E.isArguments(t)?a.call(t):t.toArray&&E.isFunction(t.toArray)?t.toArray():E.values(t):[]},E.size=function(t){return E.isArray(t)?t.length:E.keys(t).length},E.first=E.head=E.take=function(t,e,n){return null==e||n?t[0]:a.call(t,0,e)},E.initial=function(t,e,n){return a.call(t,0,t.length-(null==e||n?1:e))},E.last=function(t,e,n){return null==e||n?t[t.length-1]:a.call(t,Math.max(t.length-e,0))},E.rest=E.tail=function(t,e,n){return a.call(t,null==e||n?1:e)},E.compact=function(t){return E.filter(t,function(t){return!!t})},E.flatten=function(t,e){return E.reduce(t,function(t,n){return E.isArray(n)?t.concat(e?n:E.flatten(n)):(t[t.length]=n,t)},[])},E.without=function(t){return E.difference(t,a.call(arguments,1))},E.uniq=E.unique=function(t,e,n){var i=n?E.map(t,n):t,r=[];return 3>t.length&&(e=!0),E.reduce(i,function(n,i,o){return(e?E.last(n)===i&&n.length:E.include(n,i))||(n.push(i),r.push(t[o])),n},[]),r},E.union=function(){return E.uniq(E.flatten(arguments,!0))},E.intersection=E.intersect=function(t){var e=a.call(arguments,1);return E.filter(E.uniq(t),function(t){return E.every(e,function(e){return E.indexOf(e,t)>=0})})},E.difference=function(t){var e=E.flatten(a.call(arguments,1),!0);return E.filter(t,function(t){return!E.include(e,t)})},E.zip=function(){for(var t=a.call(arguments),e=E.max(E.pluck(t,"length")),n=Array(e),i=0;e>i;i++)n[i]=E.pluck(t,""+i);return n},E.indexOf=function(t,e,n){if(null==t)return-1;var i,r;if(n)return i=E.sortedIndex(t,e),t[i]===e?i:-1;if(w&&t.indexOf===w)return t.indexOf(e);for(i=0,r=t.length;r>i;i++)if(i in t&&t[i]===e)return i;return-1},E.lastIndexOf=function(t,e){if(null==t)return-1;if(y&&t.lastIndexOf===y)return t.lastIndexOf(e);for(var n=t.length;n--;)if(n in t&&t[n]===e)return n;return-1},E.range=function(t,e,n){1>=arguments.length&&(e=t||0,t=0),n=arguments[2]||1;for(var i=Math.max(Math.ceil((e-t)/n),0),r=0,o=Array(i);i>r;)o[r++]=t,t+=n;return o};var T=function(){};E.bind=function(t,e){var n,i;if(t.bind===_&&_)return _.apply(t,a.call(arguments,1));if(!E.isFunction(t))throw new TypeError;return i=a.call(arguments,2),n=function(){if(!(this instanceof n))return t.apply(e,i.concat(a.call(arguments)));T.prototype=t.prototype;var r=new T,o=t.apply(r,i.concat(a.call(arguments)));return Object(o)===o?o:r}},E.bindAll=function(t){var e=a.call(arguments,1);return 0==e.length&&(e=E.functions(t)),C(e,function(e){t[e]=E.bind(t[e],t)}),t},E.memoize=function(t,e){var n={};return e||(e=E.identity),function(){var i=e.apply(this,arguments);return E.has(n,i)?n[i]:n[i]=t.apply(this,arguments)}},E.delay=function(t,e){var n=a.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},E.defer=function(t){return E.delay.apply(E,[t,1].concat(a.call(arguments,1)))},E.throttle=function(t,e){var n,i,r,o,s,a,u=E.debounce(function(){s=o=!1},e);return function(){n=this,i=arguments;var c=function(){r=null,s&&t.apply(n,i),u()};return r||(r=setTimeout(c,e)),o?s=!0:a=t.apply(n,i),u(),o=!0,a}},E.debounce=function(t,e,n){var i;return function(){var r=this,o=arguments,s=function(){i=null,n||t.apply(r,o)};n&&!i&&t.apply(r,o),clearTimeout(i),i=setTimeout(s,e)}},E.once=function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments))}},E.wrap=function(t,e){return function(){var n=[t].concat(a.call(arguments,0));return e.apply(this,n)}},E.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},E.after=function(t,e){return 0>=t?e():function(){return 1>--t?e.apply(this,arguments):void 0}},E.keys=x||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var n in t)E.has(t,n)&&(e[e.length]=n);return e},E.values=function(t){return E.map(t,E.identity)},E.functions=E.methods=function(t){var e=[];for(var n in t)E.isFunction(t[n])&&e.push(n);return e.sort()},E.extend=function(t){return C(a.call(arguments,1),function(e){for(var n in e)t[n]=e[n]}),t},E.pick=function(t){var e={};return C(E.flatten(a.call(arguments,1)),function(n){n in t&&(e[n]=t[n])}),e},E.defaults=function(t){return C(a.call(arguments,1),function(e){for(var n in e)null==t[n]&&(t[n]=e[n])}),t},E.clone=function(t){return E.isObject(t)?E.isArray(t)?t.slice():E.extend({},t):t},E.tap=function(t,e){return e(t),t},E.isEqual=function(e,n){return t(e,n,[])},E.isEmpty=function(t){if(null==t)return!0;if(E.isArray(t)||E.isString(t))return 0===t.length;for(var e in t)if(E.has(t,e))return!1;return!0},E.isElement=function(t){return!(!t||1!=t.nodeType)},E.isArray=b||function(t){return"[object Array]"==c.call(t)},E.isObject=function(t){return t===Object(t)},E.isArguments=function(t){return"[object Arguments]"==c.call(t)},E.isArguments(arguments)||(E.isArguments=function(t){return!(!t||!E.has(t,"callee"))}),E.isFunction=function(t){return"[object Function]"==c.call(t)},E.isString=function(t){return"[object String]"==c.call(t)},E.isNumber=function(t){return"[object Number]"==c.call(t)},E.isFinite=function(t){return E.isNumber(t)&&isFinite(t)},E.isNaN=function(t){return t!==t},E.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==c.call(t)},E.isDate=function(t){return"[object Date]"==c.call(t)},E.isRegExp=function(t){return"[object RegExp]"==c.call(t)},E.isNull=function(t){return null===t},E.isUndefined=function(t){return void 0===t},E.has=function(t,e){return l.call(t,e)},E.noConflict=function(){return e._=n,this},E.identity=function(t){return t},E.times=function(t,e,n){for(var i=0;t>i;i++)e.call(n,i)},E.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},E.result=function(t,e){if(null==t)return null;var n=t[e];return E.isFunction(n)?n.call(t):n},E.mixin=function(t){C(E.functions(t),function(e){P(e,E[e]=t[e])})};var M=0;E.uniqueId=function(t){var e=M++;return t?t+e:e},E.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var S=/.^/,A={"\\":"\\","'":"'",r:"\r",n:"\n",t:"	",u2028:"\u2028",u2029:"\u2029"};for(var R in A)A[A[R]]=R;var I=/\\|'|\r|\n|\t|\u2028|\u2029/g,V=/\\(\\|'|r|n|t|u2028|u2029)/g,j=function(t){return t.replace(V,function(t,e){return A[e]})};E.template=function(t,e,n){n=E.defaults(n||{},E.templateSettings);var i="__p+='"+t.replace(I,function(t){return"\\"+A[t]}).replace(n.escape||S,function(t,e){return"'+\n_.escape("+j(e)+")+\n'"}).replace(n.interpolate||S,function(t,e){return"'+\n("+j(e)+")+\n'"}).replace(n.evaluate||S,function(t,e){return"';\n"+j(e)+"\n;__p+='"})+"';\n";n.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+i+"return __p;\n";var r=Function(n.variable||"obj","_",i);if(e)return r(e,E);var o=function(t){return r.call(this,t,E)};return o.source="function("+(n.variable||"obj")+"){\n"+i+"}",o},E.chain=function(t){return E(t).chain()};var O=function(t){this._wrapped=t};E.prototype=O.prototype;var z=function(t,e){return e?E(t).chain():t},P=function(t,e){O.prototype[t]=function(){var t=a.call(arguments);return u.call(t,this._wrapped),z(e.apply(E,t),this._chain)}};E.mixin(E),C(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=r[t];O.prototype[t]=function(){var n=this._wrapped;e.apply(n,arguments);var i=n.length;return"shift"!=t&&"splice"!=t||0!==i||delete n[0],z(n,this._chain)}}),C(["concat","join","slice"],function(t){var e=r[t];O.prototype[t]=function(){return z(e.apply(this._wrapped,arguments),this._chain)}}),O.prototype.chain=function(){return this._chain=!0,this},O.prototype.value=function(){return this._wrapped}}.call(this),n("underscore",function(t){return function(){var e;return e||t._}}(this)),function(){var t,n,i,r,o,s,a,u,c,l=[].slice;a=("undefined"!=typeof window&&null!==window?window._:void 0)||e("underscore"),n="pending",r="resolved",i="rejected",s=a.flatten,o=function(t,e){var n,i,r,o,a;for(o=s(t),a=[],i=0,r=o.length;r>i;i++)n=o[i],a.push(n.apply(null,e));return a},t=function(){var t,e,a,u,c,l;return l=n,u=[],c=[],t=[],a={},this.promise=function(e){var h;return e=e||{},e.state=function(){return l},h=function(t,i){return function(){return l===n&&i.push.apply(i,s(arguments)),t()&&o(arguments,a),e}},e.done=h(function(){return l===r},u),e.fail=h(function(){return l===i},c),e.always=h(function(){return l!==n},t),e},this.promise(this),e=function(e,i){return function(){return l===n&&(l=e,a=arguments,o([i,t],a)),this}},this.resolve=e(r,u),this.reject=e(i,c),this},c=function(){var e,n,i,r,o,u;for(r=new t,n=s(arguments),i=a.after(n.length,r.resolve),o=0,u=n.length;u>o;o++)e=n[o],e.done(i);return r.promise()},u=function(e){return e.Deferred=function(){return new t},e.ajax=a.wrap(e.ajax,function(e,n){var i,r;return null==n&&(n={}),r=new t,i=function(t,e){return a.wrap(t,function(){var t,n;return n=arguments[0],t=arguments.length>=2?l.call(arguments,1):[],n&&n.apply(null,t),e.apply(null,t)})},n.success=i(n.success,r.resolve),n.error=i(n.error,r.reject),e(n),r.promise()}),e.when=c},"undefined"!=typeof exports?(exports.Deferred=function(){return new t},exports.when=c,exports.installInto=u):(this.Deferred=function(){return new t},this.Deferred.when=c,this.Deferred.installInto=u)}.call(this),n("deferred",["underscore"],function(t){return function(){var e;return e||t.Deferred}}(this)),function(t){String.prototype.trim===t&&(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}),Array.prototype.reduce===t&&(Array.prototype.reduce=function(e){if(this===void 0||null===this)throw new TypeError;var n,i=Object(this),r=i.length>>>0,o=0;if("function"!=typeof e)throw new TypeError;if(0==r&&1==arguments.length)throw new TypeError;if(arguments.length>=2)n=arguments[1];else for(;;){if(o in i){n=i[o++];break}if(++o>=r)throw new TypeError}for(;r>o;)o in i&&(n=e.call(t,n,i[o],o,i)),o++;return n})}();var i=function(){function t(t){return"[object Function]"==F.call(t)}function e(t){return t instanceof Object}function n(e){var n,i;if("[object Object]"!==F.call(e))return!1;if(i=t(e.constructor)&&e.constructor.prototype,!i||!hasOwnProperty.call(i,"isPrototypeOf"))return!1;for(n in e);return n===m||hasOwnProperty.call(e,n)}function i(t){return t instanceof Array}function r(t){return"number"==typeof t.length}function o(t){return t.filter(function(t){return t!==m&&null!==t})}function s(t){return t.length>0?[].concat.apply([],t):t}function a(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function u(t){return t in k?k[t]:k[t]=RegExp("(^|\\s)"+t+"(\\s|$)")}function c(t,e){return"number"!=typeof e||M[a(t)]?e:e+"px"}function l(t){var e,n;return C[t]||(e=E.createElement(t),E.body.appendChild(e),n=T(e,"").getPropertyValue("display"),e.parentNode.removeChild(e),"none"==n&&(n="block"),C[t]=n),C[t]}function h(t,e){return e===m?v(t):v(t).filter(e)}function d(e,n,i,r){return t(n)?n.call(e,i,r):n}function f(t,e,n){var i=t%2?e:e.parentNode;i?i.insertBefore(n,t?1==t?i.firstChild:2==t?e:null:e.nextSibling):v(n).remove()}function p(t,e){e(t);for(var n in t.childNodes)p(t.childNodes[n],e)}var m,g,v,w,y,b,x=[],_=x.slice,E=window.document,C={},k={},T=E.defaultView.getComputedStyle,M={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},S=/^\s*<(\w+|!)[^>]*>/,A=[1,3,8,9,11],R=["after","prepend","before","append"],I=E.createElement("table"),V=E.createElement("tr"),j={tr:E.createElement("tbody"),tbody:I,thead:I,tfoot:I,td:V,th:V,"*":E.createElement("div")},O=/complete|loaded|interactive/,z=/^\.([\w-]+)$/,P=/^#([\w-]+)$/,N=/^[\w-]+$/,F={}.toString,$={},B=E.createElement("div");return $.matches=function(t,e){if(!t||1!==t.nodeType)return!1;var n=t.webkitMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.matchesSelector;if(n)return n.call(t,e);var i,r=t.parentNode,o=!r;return o&&(r=B).appendChild(t),i=~$.qsa(r,e).indexOf(t),o&&B.removeChild(t),i},y=function(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})},b=function(t){return t.filter(function(e,n){return t.indexOf(e)==n})},$.fragment=function(t,e){e===m&&(e=S.test(t)&&RegExp.$1),e in j||(e="*");var n=j[e];return n.innerHTML=""+t,v.each(_.call(n.childNodes),function(){n.removeChild(this)})},$.Z=function(t,e){return t=t||[],t.__proto__=arguments.callee.prototype,t.selector=e||"",t},$.isZ=function(t){return t instanceof $.Z},$.init=function(e,r){if(e){if(t(e))return v(E).ready(e);if($.isZ(e))return e;var s;if(i(e))s=o(e);else if(n(e))s=[v.extend({},e)],e=null;else if(A.indexOf(e.nodeType)>=0||e===window)s=[e],e=null;else if(S.test(e))s=$.fragment(e.trim(),RegExp.$1),e=null;else{if(r!==m)return v(r).find(e);s=$.qsa(E,e)}return $.Z(s,e)}return $.Z()},v=function(t,e){return $.init(t,e)},v.extend=function(t){return _.call(arguments,1).forEach(function(e){for(g in e)e[g]!==m&&(t[g]=e[g])}),t},$.qsa=function(t,e){var n;return t===E&&P.test(e)?(n=t.getElementById(RegExp.$1))?[n]:x:1!==t.nodeType&&9!==t.nodeType?x:_.call(z.test(e)?t.getElementsByClassName(RegExp.$1):N.test(e)?t.getElementsByTagName(e):t.querySelectorAll(e))},v.isFunction=t,v.isObject=e,v.isArray=i,v.isPlainObject=n,v.inArray=function(t,e,n){return x.indexOf.call(e,t,n)},v.trim=function(t){return t.trim()},v.uuid=0,v.map=function(t,e){var n,i,o,a=[];if(r(t))for(i=0;t.length>i;i++)n=e(t[i],i),null!=n&&a.push(n);else for(o in t)n=e(t[o],o),null!=n&&a.push(n);return s(a)},v.each=function(t,e){var n,i;if(r(t)){for(n=0;t.length>n;n++)if(e.call(t[n],n,t[n])===!1)return t}else for(i in t)if(e.call(t[i],i,t[i])===!1)return t;return t},v.fn={forEach:x.forEach,reduce:x.reduce,push:x.push,indexOf:x.indexOf,concat:x.concat,map:function(t){return v.map(this,function(e,n){return t.call(e,n,e)})},slice:function(){return v(_.apply(this,arguments))},ready:function(t){return O.test(E.readyState)?t(v):E.addEventListener("DOMContentLoaded",function(){t(v)},!1),this},get:function(t){return t===m?_.call(this):this[t]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(t){return this.forEach(function(e,n){t.call(e,n,e)}),this},filter:function(t){return v([].filter.call(this,function(e){return $.matches(e,t)}))},add:function(t,e){return v(b(this.concat(v(t,e))))},is:function(t){return this.length>0&&$.matches(this[0],t)},not:function(e){var n=[];if(t(e)&&e.call!==m)this.each(function(t){e.call(this,t)||n.push(this)});else{var i="string"==typeof e?this.filter(e):r(e)&&t(e.item)?_.call(e):v(e);this.forEach(function(t){0>i.indexOf(t)&&n.push(t)})}return v(n)},eq:function(t){return-1===t?this.slice(t):this.slice(t,+t+1)},first:function(){var t=this[0];return t&&!e(t)?t:v(t)},last:function(){var t=this[this.length-1];return t&&!e(t)?t:v(t)},find:function(t){var e;return e=1==this.length?$.qsa(this[0],t):this.map(function(){return $.qsa(this,t)}),v(e)},closest:function(t,e){for(var n=this[0];n&&!$.matches(n,t);)n=n!==e&&n!==E&&n.parentNode;return v(n)},parents:function(t){for(var e=[],n=this;n.length>0;)n=v.map(n,function(t){return(t=t.parentNode)&&t!==E&&0>e.indexOf(t)?(e.push(t),t):m});return h(e,t)},parent:function(t){return h(b(this.pluck("parentNode")),t)},children:function(t){return h(this.map(function(){return _.call(this.children)}),t)},siblings:function(t){return h(this.map(function(t,e){return _.call(e.parentNode.children).filter(function(t){return t!==e})}),t)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(t){return this.map(function(){return this[t]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=null),"none"==T(this,"").getPropertyValue("display")&&(this.style.display=l(this.nodeName))})},replaceWith:function(t){return this.before(t).remove()},wrap:function(t){return this.each(function(){v(this).wrapAll(v(t)[0].cloneNode(!1))})},wrapAll:function(t){return this[0]&&(v(this[0]).before(t=v(t)),t.append(this)),this},unwrap:function(){return this.parent().each(function(){v(this).replaceWith(v(this).children())}),this},clone:function(){return v(this.map(function(){return this.cloneNode(!0)}))},hide:function(){return this.css("display","none")},toggle:function(t){return(t===m?"none"==this.css("display"):t)?this.show():this.hide()},prev:function(){return v(this.pluck("previousElementSibling"))},next:function(){return v(this.pluck("nextElementSibling"))},html:function(t){return t===m?this.length>0?this[0].innerHTML:null:this.each(function(e){var n=this.innerHTML;v(this).empty().append(d(this,t,e,n))})},text:function(t){return t===m?this.length>0?this[0].textContent:null:this.each(function(){this.textContent=t})},attr:function(t,n){var i;return"string"==typeof t&&n===m?0==this.length||1!==this[0].nodeType?m:"value"==t&&"INPUT"==this[0].nodeName?this.val():!(i=this[0].getAttribute(t))&&t in this[0]?this[0][t]:i:this.each(function(i){if(1===this.nodeType)if(e(t))for(g in t)this.setAttribute(g,t[g]);else this.setAttribute(t,d(this,n,i,this.getAttribute(t)))})},removeAttr:function(t){return this.each(function(){1===this.nodeType&&this.removeAttribute(t)})},prop:function(t,e){return e===m?this[0]?this[0][t]:m:this.each(function(n){this[t]=d(this,e,n,this[t])})},data:function(t,e){var n=this.attr("data-"+a(t),e);return null!==n?n:m},val:function(t){return t===m?this.length>0?this[0].value:m:this.each(function(e){this.value=d(this,t,e,this.value)})},offset:function(){if(0==this.length)return null;var t=this[0].getBoundingClientRect();return{left:t.left+window.pageXOffset,top:t.top+window.pageYOffset,width:t.width,height:t.height}},css:function(t,e){if(e===m&&"string"==typeof t)return 0==this.length?m:this[0].style[y(t)]||T(this[0],"").getPropertyValue(t);var n="";for(g in t)"string"==typeof t[g]&&""==t[g]?this.each(function(){this.style.removeProperty(a(g))}):n+=a(g)+":"+c(g,t[g])+";";return"string"==typeof t&&(""==e?this.each(function(){this.style.removeProperty(a(t))}):n=a(t)+":"+c(t,e)),this.each(function(){this.style.cssText+=";"+n})},index:function(t){return t?this.indexOf(v(t)[0]):this.parent().children().indexOf(this[0])},hasClass:function(t){return 1>this.length?!1:u(t).test(this[0].className)},addClass:function(t){return this.each(function(e){w=[];var n=this.className,i=d(this,t,e,n);i.split(/\s+/g).forEach(function(t){v(this).hasClass(t)||w.push(t)},this),w.length&&(this.className+=(n?" ":"")+w.join(" "))})},removeClass:function(t){return this.each(function(e){return t===m?this.className="":(w=this.className,d(this,t,e,w).split(/\s+/g).forEach(function(t){w=w.replace(u(t)," ")}),this.className=w.trim(),m)})},toggleClass:function(t,e){return this.each(function(n){var i=d(this,t,n,this.className);(e===m?!v(this).hasClass(i):e)?v(this).addClass(i):v(this).removeClass(i)})}},["width","height"].forEach(function(t){v.fn[t]=function(e){var n,i=t.replace(/./,function(t){return t[0].toUpperCase()});return e===m?this[0]==window?window["inner"+i]:this[0]==E?E.documentElement["offset"+i]:(n=this.offset())&&n[t]:this.each(function(n){var i=v(this);i.css(t,d(this,e,n,i[t]()))})}}),R.forEach(function(t,n){v.fn[t]=function(){var t=v.map(arguments,function(t){return e(t)?t:$.fragment(t)});if(1>t.length)return this;var i=this.length,r=i>1,o=2>n;return this.each(function(e,s){for(var a=0;t.length>a;a++){var u=t[o?t.length-a-1:a];p(u,function(t){null==t.nodeName||"SCRIPT"!==t.nodeName.toUpperCase()||t.type&&"text/javascript"!==t.type||window.eval.call(window,t.innerHTML)}),r&&i-1>e&&(u=u.cloneNode(!0)),f(n,s,u)}})},v.fn[n%2?t+"To":"insert"+(n?"Before":"After")]=function(e){return v(e)[t](this),this}}),$.Z.prototype=v.fn,$.camelize=y,$.uniq=b,v.zepto=$,v}();window.Zepto=i,"$"in window||(window.$=i),function(t){function e(t){return t._zid||(t._zid=h++)}function n(t,n,o,s){if(n=i(n),n.ns)var a=r(n.ns);return(l[e(t)]||[]).filter(function(t){return!(!t||n.e&&t.e!=n.e||n.ns&&!a.test(t.ns)||o&&e(t.fn)!==e(o)||s&&t.sel!=s)})}function i(t){var e=(""+t).split(".");return{e:e[0],ns:e.slice(1).sort().join(" ")}}function r(t){return RegExp("(?:^| )"+t.replace(" "," .* ?")+"(?: |$)")}function o(e,n,i){t.isObject(e)?t.each(e,i):e.split(/\s/).forEach(function(t){i(t,n)})}function s(n,r,s,a,u,c){c=!!c;var h=e(n),d=l[h]||(l[h]=[]);o(r,s,function(e,r){var o=u&&u(r,e),s=o||r,l=function(t){var e=s.apply(n,[t].concat(t.data));return e===!1&&t.preventDefault(),e},h=t.extend(i(e),{fn:r,proxy:l,sel:a,del:o,i:d.length});d.push(h),n.addEventListener(h.e,l,c)})}function a(t,i,r,s){var a=e(t);o(i||"",r,function(e,i){n(t,e,i,s).forEach(function(e){delete l[a][e.i],t.removeEventListener(e.e,e.proxy,!1)})})}function u(e){var n=t.extend({originalEvent:e},e);return t.each(m,function(t,i){n[t]=function(){return this[i]=f,e[t].apply(e,arguments)},n[i]=p}),n}function c(t){if(!("defaultPrevented"in t)){t.defaultPrevented=!1;var e=t.preventDefault;t.preventDefault=function(){this.defaultPrevented=!0,e.call(this)}}}var l=(t.zepto.qsa,{}),h=1,d={};d.click=d.mousedown=d.mouseup=d.mousemove="MouseEvents",t.event={add:s,remove:a},t.proxy=function(n,i){if(t.isFunction(n)){var r=function(){return n.apply(i,arguments)};return r._zid=e(n),r}if("string"==typeof i)return t.proxy(n[i],n);throw new TypeError("expected function")},t.fn.bind=function(t,e){return this.each(function(){s(this,t,e)})},t.fn.unbind=function(t,e){return this.each(function(){a(this,t,e)})},t.fn.one=function(t,e){return this.each(function(n,i){s(this,t,e,null,function(t,e){return function(){var n=t.apply(i,arguments);return a(i,e,t),n}})})};var f=function(){return!0},p=function(){return!1},m={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};t.fn.delegate=function(e,n,i){var r=!1;return("blur"==n||"focus"==n)&&(t.iswebkit?n="blur"==n?"focusout":"focus"==n?"focusin":n:r=!0),this.each(function(o,a){s(a,n,i,e,function(n){return function(i){var r,o=t(i.target).closest(e,a).get(0);return o?(r=t.extend(u(i),{currentTarget:o,liveFired:a}),n.apply(o,[r].concat([].slice.call(arguments,1)))):void 0}},r)})},t.fn.undelegate=function(t,e,n){return this.each(function(){a(this,e,n,t)})},t.fn.live=function(e,n){return t(document.body).delegate(this.selector,e,n),this},t.fn.die=function(e,n){return t(document.body).undelegate(this.selector,e,n),this},t.fn.on=function(e,n,i){return void 0==n||t.isFunction(n)?this.bind(e,n):this.delegate(n,e,i)},t.fn.off=function(e,n,i){return void 0==n||t.isFunction(n)?this.unbind(e,n):this.undelegate(n,e,i)},t.fn.trigger=function(e,n){return"string"==typeof e&&(e=t.Event(e)),c(e),e.data=n,this.each(function(){"dispatchEvent"in this&&this.dispatchEvent(e)})},t.fn.triggerHandler=function(e,i){var r,o;return this.each(function(s,a){r=u("string"==typeof e?t.Event(e):e),r.data=i,r.target=a,t.each(n(a,e.type||e),function(t,e){return o=e.proxy(r),r.isImmediatePropagationStopped()?!1:void 0})}),o},"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout change select keydown keypress keyup error".split(" ").forEach(function(e){t.fn[e]=function(t){return this.bind(e,t)}}),["focus","blur"].forEach(function(e){t.fn[e]=function(t){if(t)this.bind(e,t);else if(this.length)try{this.get(0)[e]()}catch(n){}return this}}),t.Event=function(t,e){var n=document.createEvent(d[t]||"Events"),i=!0;if(e)for(var r in e)"bubbles"==r?i=!!e[r]:n[r]=e[r];return n.initEvent(t,i,!0,null,null,null,null,null,null,null,null,null,null,null,null),n}}(i),function(t){function e(t){var e=this.os={},n=this.browser={},i=t.match(/WebKit\/([\d.]+)/),r=t.match(/(Android)\s+([\d.]+)/),o=t.match(/(iPad).*OS\s([\d_]+)/),s=!o&&t.match(/(iPhone\sOS)\s([\d_]+)/),a=t.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),u=a&&t.match(/TouchPad/),c=t.match(/Kindle\/([\d.]+)/),l=t.match(/Silk\/([\d._]+)/),h=t.match(/(BlackBerry).*Version\/([\d.]+)/);(n.webkit=!!i)&&(n.version=i[1]),r&&(e.android=!0,e.version=r[2]),s&&(e.ios=e.iphone=!0,e.version=s[2].replace(/_/g,".")),o&&(e.ios=e.ipad=!0,e.version=o[2].replace(/_/g,".")),a&&(e.webos=!0,e.version=a[2]),u&&(e.touchpad=!0),h&&(e.blackberry=!0,e.version=h[2]),c&&(e.kindle=!0,e.version=c[1]),l&&(n.silk=!0,n.version=l[1]),!l&&e.android&&t.match(/Kindle Fire/)&&(n.silk=!0)}e.call(t,navigator.userAgent),t.__detect=e}(i),function(t,e){function n(t){return t.toLowerCase()}function i(t){return r?r+t:n(t)}var r,o="",s={Webkit:"webkit",Moz:"",O:"o",ms:"MS"},a=window.document,u=a.createElement("div"),c=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,l={};t.each(s,function(t,i){return u.style[t+"TransitionProperty"]!==e?(o="-"+n(t)+"-",r=i,!1):e}),l[o+"transition-property"]=l[o+"transition-duration"]=l[o+"transition-timing-function"]=l[o+"animation-name"]=l[o+"animation-duration"]="",t.fx={off:r===e&&u.style.transitionProperty===e,cssPrefix:o,transitionEnd:i("TransitionEnd"),animationEnd:i("AnimationEnd")},t.fn.animate=function(e,n,i,r){return t.isObject(n)&&(i=n.easing,r=n.complete,n=n.duration),n&&(n/=1e3),this.anim(e,n,i,r)
},t.fn.anim=function(n,i,r,s){var a,u,h,d={},f=this,p=t.fx.transitionEnd;if(i===e&&(i=.4),t.fx.off&&(i=0),"string"==typeof n)d[o+"animation-name"]=n,d[o+"animation-duration"]=i+"s",p=t.fx.animationEnd;else{for(u in n)c.test(u)?(a||(a=[]),a.push(u+"("+n[u]+")")):d[u]=n[u];a&&(d[o+"transform"]=a.join(" ")),t.fx.off||"object"!=typeof n||(d[o+"transition-property"]=Object.keys(n).join(", "),d[o+"transition-duration"]=i+"s",d[o+"transition-timing-function"]=r||"linear")}return h=function(n){if(n!==e){if(n.target!==n.currentTarget)return;t(n.target).unbind(p,arguments.callee)}t(this).css(l),s&&s.call(this)},i>0&&this.bind(p,h),setTimeout(function(){f.css(d),0>=i&&setTimeout(function(){f.each(function(){h.call(this)})},0)},0),this},u=null}(i),function(t){function e(e,n,i){var r=t.Event(n);return t(e).trigger(r,i),!r.defaultPrevented}function n(t,n,i,r){return t.global?e(n||w,i,r):void 0}function i(e){e.global&&0===t.active++&&n(e,null,"ajaxStart")}function r(e){e.global&&!--t.active&&n(e,null,"ajaxStop")}function o(t,e){var i=e.context;return e.beforeSend.call(i,t,e)===!1||n(e,i,"ajaxBeforeSend",[t,e])===!1?!1:(n(e,i,"ajaxSend",[t,e]),void 0)}function s(t,e,i){var r=i.context,o="success";i.success.call(r,t,o,e),n(i,r,"ajaxSuccess",[e,i,t]),u(o,e,i)}function a(t,e,i,r){var o=r.context;r.error.call(o,i,e,t),n(r,o,"ajaxError",[i,r,t]),u(e,i,r)}function u(t,e,i){var o=i.context;i.complete.call(o,e,t),n(i,o,"ajaxComplete",[e,i]),r(i)}function c(){}function l(t){return t&&(t==E?"html":t==_?"json":b.test(t)?"script":x.test(t)&&"xml")||"text"}function h(t,e){return(t+"&"+e).replace(/[&?]{1,2}/,"?")}function d(e){v(e.data)&&(e.data=t.param(e.data)),!e.data||e.type&&"GET"!=e.type.toUpperCase()||(e.url=h(e.url,e.data))}function f(e,n,i,r){var o=t.isArray(n);t.each(n,function(n,s){r&&(n=i?r:r+"["+(o?"":n)+"]"),!r&&o?e.add(s.name,s.value):(i?t.isArray(s):v(s))?f(e,s,i,n):e.add(n,s)})}var p,m,g=0,v=t.isObject,w=window.document,y=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,b=/^(?:text|application)\/javascript/i,x=/^(?:text|application)\/xml/i,_="application/json",E="text/html",C=/^\s*$/;t.active=0,t.ajaxJSONP=function(e){var n,i="jsonp"+ ++g,r=w.createElement("script"),o=function(){t(r).remove(),i in window&&(window[i]=c),u("abort",a,e)},a={abort:o};return e.error&&(r.onerror=function(){a.abort(),e.error()}),window[i]=function(o){clearTimeout(n),t(r).remove(),delete window[i],s(o,a,e)},d(e),r.src=e.url.replace(/=\?/,"="+i),t("head").append(r),e.timeout>0&&(n=setTimeout(function(){a.abort(),u("timeout",a,e)},e.timeout)),a},t.ajaxSettings={type:"GET",beforeSend:c,success:c,error:c,complete:c,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript",json:_,xml:"application/xml, text/xml",html:E,text:"text/plain"},crossDomain:!1,timeout:0},t.ajax=function(e){var n=t.extend({},e||{});for(p in t.ajaxSettings)void 0===n[p]&&(n[p]=t.ajaxSettings[p]);i(n),n.crossDomain||(n.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(n.url)&&RegExp.$2!=window.location.host);var r=n.dataType,u=/=\?/.test(n.url);if("jsonp"==r||u)return u||(n.url=h(n.url,"callback=?")),t.ajaxJSONP(n);n.url||(n.url=""+window.location),d(n);var f,g=n.accepts[r],v={},w=/^([\w-]+:)\/\//.test(n.url)?RegExp.$1:window.location.protocol,y=t.ajaxSettings.xhr();n.crossDomain||(v["X-Requested-With"]="XMLHttpRequest"),g&&(v.Accept=g,g.indexOf(",")>-1&&(g=g.split(",",2)[0]),y.overrideMimeType&&y.overrideMimeType(g)),(n.contentType||n.data&&"GET"!=n.type.toUpperCase())&&(v["Content-Type"]=n.contentType||"application/x-www-form-urlencoded"),n.headers=t.extend(v,n.headers||{}),y.onreadystatechange=function(){if(4==y.readyState){clearTimeout(f);var t,e=!1;if(y.status>=200&&300>y.status||304==y.status||0==y.status&&"file:"==w){r=r||l(y.getResponseHeader("content-type")),t=y.responseText;try{"script"==r?(1,eval)(t):"xml"==r?t=y.responseXML:"json"==r&&(t=C.test(t)?null:JSON.parse(t))}catch(i){e=i}e?a(e,"parsererror",y,n):s(t,y,n)}else a(null,"error",y,n)}};var b="async"in n?n.async:!0;y.open(n.type,n.url,b);for(m in n.headers)y.setRequestHeader(m,n.headers[m]);return o(y,n)===!1?(y.abort(),!1):(n.timeout>0&&(f=setTimeout(function(){y.onreadystatechange=c,y.abort(),a(null,"timeout",y,n)},n.timeout)),y.send(n.data?n.data:null),y)},t.get=function(e,n){return t.ajax({url:e,success:n})},t.post=function(e,n,i,r){return t.isFunction(n)&&(r=r||i,i=n,n=null),t.ajax({type:"POST",url:e,data:n,success:i,dataType:r})},t.getJSON=function(e,n){return t.ajax({url:e,success:n,dataType:"json"})},t.fn.load=function(e,n){if(!this.length)return this;var i,r=this,o=e.split(/\s/);return o.length>1&&(e=o[0],i=o[1]),t.get(e,function(e){r.html(i?t(w.createElement("div")).html(e.replace(y,"")).find(i).html():e),n&&n.call(r)}),this};var k=encodeURIComponent;t.param=function(t,e){var n=[];return n.add=function(t,e){this.push(k(t)+"="+k(e))},f(n,t,e),n.join("&").replace("%20","+")}}(i),function(t){t.fn.serializeArray=function(){var e,n=[];return t(Array.prototype.slice.call(this.get(0).elements)).each(function(){e=t(this);var i=e.attr("type");"fieldset"!=this.nodeName.toLowerCase()&&!this.disabled&&"submit"!=i&&"reset"!=i&&"button"!=i&&("radio"!=i&&"checkbox"!=i||this.checked)&&n.push({name:e.attr("name"),value:e.val()})}),n},t.fn.serialize=function(){var t=[];return this.serializeArray().forEach(function(e){t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")},t.fn.submit=function(e){if(e)this.bind("submit",e);else if(this.length){var n=t.Event("submit");this.eq(0).trigger(n),n.defaultPrevented||this.get(0).submit()}return this}}(i),function(t){function e(t){return"tagName"in t?t:t.parentNode}function n(t,e,n,i){var r=Math.abs(t-e),o=Math.abs(n-i);return r>=o?t-e>0?"Left":"Right":n-i>0?"Up":"Down"}function i(){s=null,a.last&&(a.el.trigger("longTap"),a={})}function r(){s&&clearTimeout(s),s=null}var o,s,a={},u=750;t(document).ready(function(){var c,l;t(document.body).bind("touchstart",function(n){c=Date.now(),l=c-(a.last||c),a.el=t(e(n.touches[0].target)),o&&clearTimeout(o),a.x1=n.touches[0].pageX,a.y1=n.touches[0].pageY,l>0&&250>=l&&(a.isDoubleTap=!0),a.last=c,s=setTimeout(i,u)}).bind("touchmove",function(t){r(),a.x2=t.touches[0].pageX,a.y2=t.touches[0].pageY}).bind("touchend",function(){r(),a.isDoubleTap?(a.el.trigger("doubleTap"),a={}):a.x2&&Math.abs(a.x1-a.x2)>30||a.y2&&Math.abs(a.y1-a.y2)>30?(a.el.trigger("swipe")&&a.el.trigger("swipe"+n(a.x1,a.x2,a.y1,a.y2)),a={}):"last"in a&&(a.el.trigger("tap"),o=setTimeout(function(){o=null,a.el.trigger("singleTap"),a={}},250))}).bind("touchcancel",function(){o&&clearTimeout(o),s&&clearTimeout(s),s=o=null,a={}})}),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach(function(e){t.fn[e]=function(t){return this.bind(e,t)}})}(i),n("zepto",["deferred"],function(t){return function(){var e,n;return n=function(t){return t.installInto(this.$),this.$},e=n.apply(t,arguments),e||t.$}}(this)),function(){var t,n=this,i=n.Backbone,r=Array.prototype.slice,o=Array.prototype.splice;t="undefined"!=typeof exports?exports:n.Backbone={},t.VERSION="0.9.2";var s=n._;s||void 0===e||(s=e("underscore"));var a=n.jQuery||n.Zepto||n.ender;t.setDomLibrary=function(t){a=t},t.noConflict=function(){return n.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var u=/\s+/,c=t.Events={on:function(t,e,n){var i,r,o,s,a;if(!e)return this;for(t=t.split(u),i=this._callbacks||(this._callbacks={});r=t.shift();)a=i[r],o=a?a.tail:{},o.next=s={},o.context=n,o.callback=e,i[r]={tail:s,next:a?a.next:o};return this},off:function(t,e,n){var i,r,o,a,c,l;if(r=this._callbacks){if(!(t||e||n))return delete this._callbacks,this;for(t=t?t.split(u):s.keys(r);i=t.shift();)if(o=r[i],delete r[i],o&&(e||n))for(a=o.tail;(o=o.next)!==a;)c=o.callback,l=o.context,(e&&c!==e||n&&l!==n)&&this.on(i,c,l);return this}},trigger:function(t){var e,n,i,o,s,a,c;if(!(i=this._callbacks))return this;for(a=i.all,t=t.split(u),c=r.call(arguments,1);e=t.shift();){if(n=i[e])for(o=n.tail;(n=n.next)!==o;)n.callback.apply(n.context||this,c);if(n=a)for(o=n.tail,s=[e].concat(c);(n=n.next)!==o;)n.callback.apply(n.context||this,s)}return this}};c.bind=c.on,c.unbind=c.off;var l=t.Model=function(t,e){var n;t||(t={}),e&&e.parse&&(t=this.parse(t)),(n=M(this,"defaults"))&&(t=s.extend({},n,t)),e&&e.collection&&(this.collection=e.collection),this.attributes={},this._escapedAttributes={},this.cid=s.uniqueId("c"),this.changed={},this._silent={},this._pending={},this.set(t,{silent:!0}),this.changed={},this._silent={},this._pending={},this._previousAttributes=s.clone(this.attributes),this.initialize.apply(this,arguments)};s.extend(l.prototype,c,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(){return s.clone(this.attributes)},get:function(t){return this.attributes[t]},escape:function(t){var e;if(e=this._escapedAttributes[t])return e;var n=this.get(t);return this._escapedAttributes[t]=s.escape(null==n?"":""+n)},has:function(t){return null!=this.get(t)},set:function(t,e,n){var i,r,o;if(s.isObject(t)||null==t?(i=t,n=e):(i={},i[t]=e),n||(n={}),!i)return this;if(i instanceof l&&(i=i.attributes),n.unset)for(r in i)i[r]=void 0;if(!this._validate(i,n))return!1;this.idAttribute in i&&(this.id=i[this.idAttribute]);var a=n.changes={},u=this.attributes,c=this._escapedAttributes,h=this._previousAttributes||{};for(r in i)o=i[r],(!s.isEqual(u[r],o)||n.unset&&s.has(u,r))&&(delete c[r],(n.silent?this._silent:a)[r]=!0),n.unset?delete u[r]:u[r]=o,s.isEqual(h[r],o)&&s.has(u,r)==s.has(h,r)?(delete this.changed[r],delete this._pending[r]):(this.changed[r]=o,n.silent||(this._pending[r]=!0));return n.silent||this.change(n),this},unset:function(t,e){return(e||(e={})).unset=!0,this.set(t,null,e)},clear:function(t){return(t||(t={})).unset=!0,this.set(s.clone(this.attributes),t)},fetch:function(e){e=e?s.clone(e):{};var n=this,i=e.success;return e.success=function(t,r,o){return n.set(n.parse(t,o),e)?(i&&i(n,t),void 0):!1},e.error=t.wrapError(e.error,n,e),(this.sync||t.sync).call(this,"read",this,e)},save:function(e,n,i){var r,o;if(s.isObject(e)||null==e?(r=e,i=n):(r={},r[e]=n),i=i?s.clone(i):{},i.wait){if(!this._validate(r,i))return!1;o=s.clone(this.attributes)}var a=s.extend({},i,{silent:!0});if(r&&!this.set(r,i.wait?a:i))return!1;var u=this,c=i.success;i.success=function(t,e,n){var o=u.parse(t,n);return i.wait&&(delete i.wait,o=s.extend(r||{},o)),u.set(o,i)?(c?c(u,t):u.trigger("sync",u,t,i),void 0):!1},i.error=t.wrapError(i.error,u,i);var l=this.isNew()?"create":"update",h=(this.sync||t.sync).call(this,l,this,i);return i.wait&&this.set(o,a),h},destroy:function(e){e=e?s.clone(e):{};var n=this,i=e.success,r=function(){n.trigger("destroy",n,n.collection,e)};if(this.isNew())return r(),!1;e.success=function(t){e.wait&&r(),i?i(n,t):n.trigger("sync",n,t,e)},e.error=t.wrapError(e.error,n,e);var o=(this.sync||t.sync).call(this,"delete",this,e);return e.wait||r(),o},url:function(){var t=M(this,"urlRoot")||M(this.collection,"url")||S();return this.isNew()?t:t+("/"==t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(t){t||(t={});var e=this._changing;this._changing=!0;for(var n in this._silent)this._pending[n]=!0;var i=s.extend({},t.changes,this._silent);this._silent={};for(var n in i)this.trigger("change:"+n,this,this.get(n),t);if(e)return this;for(;!s.isEmpty(this._pending);){this._pending={},this.trigger("change",this,t);for(var n in this.changed)this._pending[n]||this._silent[n]||delete this.changed[n];this._previousAttributes=s.clone(this.attributes)}return this._changing=!1,this},hasChanged:function(t){return arguments.length?s.has(this.changed,t):!s.isEmpty(this.changed)},changedAttributes:function(t){if(!t)return this.hasChanged()?s.clone(this.changed):!1;var e,n=!1,i=this._previousAttributes;for(var r in t)s.isEqual(i[r],e=t[r])||((n||(n={}))[r]=e);return n},previous:function(t){return arguments.length&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return s.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(t,e){if(e.silent||!this.validate)return!0;t=s.extend({},this.attributes,t);var n=this.validate(t,e);return n?(e&&e.error?e.error(this,n,e):this.trigger("error",this,n,e),!1):!0}});var h=t.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,{silent:!0,parse:e.parse})};s.extend(h.prototype,c,{model:l,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},add:function(t,e){var n,i,r,a,u,c,l={},h={},d=[];for(e||(e={}),t=s.isArray(t)?t.slice():[t],n=0,r=t.length;r>n;n++){if(!(a=t[n]=this._prepareModel(t[n],e)))throw Error("Can't add an invalid model to a collection");u=a.cid,c=a.id,l[u]||this._byCid[u]||null!=c&&(h[c]||this._byId[c])?d.push(n):l[u]=h[c]=a}for(n=d.length;n--;)t.splice(d[n],1);for(n=0,r=t.length;r>n;n++)(a=t[n]).on("all",this._onModelEvent,this),this._byCid[a.cid]=a,null!=a.id&&(this._byId[a.id]=a);if(this.length+=r,i=null!=e.at?e.at:this.models.length,o.apply(this.models,[i,0].concat(t)),this.comparator&&this.sort({silent:!0}),e.silent)return this;for(n=0,r=this.models.length;r>n;n++)l[(a=this.models[n]).cid]&&(e.index=n,a.trigger("add",a,this,e));return this},remove:function(t,e){var n,i,r,o;for(e||(e={}),t=s.isArray(t)?t.slice():[t],n=0,i=t.length;i>n;n++)o=this.getByCid(t[n])||this.get(t[n]),o&&(delete this._byId[o.id],delete this._byCid[o.cid],r=this.indexOf(o),this.models.splice(r,1),this.length--,e.silent||(e.index=r,o.trigger("remove",o,this,e)),this._removeReference(o));return this},push:function(t,e){return t=this._prepareModel(t,e),this.add(t,e),t},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return t=this._prepareModel(t,e),this.add(t,s.extend({at:0},e)),t},shift:function(t){var e=this.at(0);return this.remove(e,t),e},get:function(t){return null==t?void 0:this._byId[null!=t.id?t.id:t]},getByCid:function(t){return t&&this._byCid[t.cid||t]},at:function(t){return this.models[t]},where:function(t){return s.isEmpty(t)?[]:this.filter(function(e){for(var n in t)if(t[n]!==e.get(n))return!1;return!0})},sort:function(t){if(t||(t={}),!this.comparator)throw Error("Cannot sort a set without a comparator");var e=s.bind(this.comparator,this);return 1==this.comparator.length?this.models=this.sortBy(e):this.models.sort(e),t.silent||this.trigger("reset",this,t),this},pluck:function(t){return s.map(this.models,function(e){return e.get(t)})},reset:function(t,e){t||(t=[]),e||(e={});for(var n=0,i=this.models.length;i>n;n++)this._removeReference(this.models[n]);return this._reset(),this.add(t,s.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),this},fetch:function(e){e=e?s.clone(e):{},void 0===e.parse&&(e.parse=!0);var n=this,i=e.success;return e.success=function(t,r,o){n[e.add?"add":"reset"](n.parse(t,o),e),i&&i(n,t)},e.error=t.wrapError(e.error,n,e),(this.sync||t.sync).call(this,"read",this,e)},create:function(t,e){var n=this;if(e=e?s.clone(e):{},t=this._prepareModel(t,e),!t)return!1;e.wait||n.add(t,e);var i=e.success;return e.success=function(r,o){e.wait&&n.add(r,e),i?i(r,o):r.trigger("sync",t,o,e)},t.save(null,e),t},parse:function(t){return t},chain:function(){return s(this.models).chain()},_reset:function(){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(t,e){if(e||(e={}),t instanceof l)t.collection||(t.collection=this);else{var n=t;e.collection=this,t=new this.model(n,e),t._validate(t.attributes,e)||(t=!1)}return t},_removeReference:function(t){this==t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){("add"!=t&&"remove"!=t||n==this)&&("destroy"==t&&this.remove(e,i),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],this._byId[e.id]=e),this.trigger.apply(this,arguments))}});var d=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];s.each(d,function(t){h.prototype[t]=function(){return s[t].apply(s,[this.models].concat(s.toArray(arguments)))}});var f=t.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},p=/:\w+/g,m=/\*\w+/g,g=/[-[\]{}()+?.,\\^$|#\s]/g;s.extend(f.prototype,c,{initialize:function(){},route:function(e,n,i){return t.history||(t.history=new v),s.isRegExp(e)||(e=this._routeToRegExp(e)),i||(i=this[n]),t.history.route(e,s.bind(function(r){var o=this._extractParameters(e,r);i&&i.apply(this,o),this.trigger.apply(this,["route:"+n].concat(o)),t.history.trigger("route",this,n,o)},this)),this},navigate:function(e,n){t.history.navigate(e,n)},_bindRoutes:function(){if(this.routes){var t=[];for(var e in this.routes)t.unshift([e,this.routes[e]]);for(var n=0,i=t.length;i>n;n++)this.route(t[n][0],t[n][1],this[t[n][1]])}},_routeToRegExp:function(t){return t=t.replace(g,"\\$&").replace(p,"([^/]+)").replace(m,"(.*?)"),RegExp("^"+t+"$")},_extractParameters:function(t,e){return t.exec(e).slice(1)}});var v=t.History=function(){this.handlers=[],s.bindAll(this,"checkUrl")},w=/^[#\/]/,y=/msie [\w.]+/;v.started=!1,s.extend(v.prototype,c,{interval:50,getHash:function(t){var e=t?t.location:window.location,n=e.href.match(/#(.*)$/);return n?n[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||e){t=window.location.pathname;var n=window.location.search;n&&(t+=n)}else t=this.getHash();return t.indexOf(this.options.root)||(t=t.substr(this.options.root.length)),t.replace(w,"")},start:function(t){if(v.started)throw Error("Backbone.history has already been started");v.started=!0,this.options=s.extend({},{root:"/"},this.options,t),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var e=this.getFragment(),n=document.documentMode,i=y.exec(navigator.userAgent.toLowerCase())&&(!n||7>=n);i&&(this.iframe=a('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(e)),this._hasPushState?a(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!i?a(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=e;var r=window.location,o=r.pathname==this.options.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!o?(this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&o&&r.hash&&(this.fragment=this.getHash().replace(w,""),window.history.replaceState({},document.title,r.protocol+"//"+r.host+this.options.root+this.fragment)),this.options.silent?void 0:this.loadUrl())},stop:function(){a(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),v.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();return t==this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t==this.fragment?!1:(this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash()),void 0)},loadUrl:function(t){var e=this.fragment=this.getFragment(t),n=s.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0});return n},navigate:function(t,e){if(!v.started)return!1;e&&e!==!0||(e={trigger:e});var n=(t||"").replace(w,"");this.fragment!=n&&(this._hasPushState?(0!=n.indexOf(this.options.root)&&(n=this.options.root+n),this.fragment=n,window.history[e.replace?"replaceState":"pushState"]({},document.title,n)):this._wantsHashChange?(this.fragment=n,this._updateHash(window.location,n,e.replace),this.iframe&&n!=this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,n,e.replace))):window.location.assign(this.options.root+t),e.trigger&&this.loadUrl(t))},_updateHash:function(t,e,n){n?t.replace((""+t).replace(/(javascript:|#).*$/,"")+"#"+e):t.hash=e}});var b=t.View=function(t){this.cid=s.uniqueId("view"),this._configure(t||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},x=/^(\S+)\s*(.*)$/,_=["model","collection","el","id","attributes","className","tagName"];s.extend(b.prototype,c,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(t,e,n){var i=document.createElement(t);return e&&a(i).attr(e),n&&a(i).html(n),i},setElement:function(t,e){return this.$el&&this.undelegateEvents(),this.$el=t instanceof a?t:a(t),this.el=this.$el[0],e!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(t||(t=M(this,"events"))){this.undelegateEvents();for(var e in t){var n=t[e];if(s.isFunction(n)||(n=this[t[e]]),!n)throw Error('Method "'+t[e]+'" does not exist');var i=e.match(x),r=i[1],o=i[2];n=s.bind(n,this),r+=".delegateEvents"+this.cid,""===o?this.$el.bind(r,n):this.$el.delegate(o,r,n)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(t){this.options&&(t=s.extend({},this.options,t));for(var e=0,n=_.length;n>e;e++){var i=_[e];t[i]&&(this[i]=t[i])}this.options=t},_ensureElement:function(){if(this.el)this.setElement(this.el,!1);else{var t=M(this,"attributes")||{};this.id&&(t.id=this.id),this.className&&(t["class"]=this.className),this.setElement(this.make(this.tagName,t),!1)}}});var E=function(t,e){var n=T(this,t,e);return n.extend=this.extend,n};l.extend=h.extend=f.extend=b.extend=E;var C={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};t.sync=function(e,n,i){var r=C[e];i||(i={});var o={type:r,dataType:"json"};return i.url||(o.url=M(n,"url")||S()),i.data||!n||"create"!=e&&"update"!=e||(o.contentType="application/json",o.data=JSON.stringify(n.toJSON())),t.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),t.emulateHTTP&&("PUT"===r||"DELETE"===r)&&(t.emulateJSON&&(o.data._method=r),o.type="POST",o.beforeSend=function(t){t.setRequestHeader("X-HTTP-Method-Override",r)}),"GET"===o.type||t.emulateJSON||(o.processData=!1),a.ajax(s.extend(o,i))},t.wrapError=function(t,e,n){return function(i,r){r=i===e?r:i,t?t(e,r,n):e.trigger("error",e,r,n)}};var k=function(){},T=function(t,e,n){var i;return i=e&&e.hasOwnProperty("constructor")?e.constructor:function(){t.apply(this,arguments)},s.extend(i,t),k.prototype=t.prototype,i.prototype=new k,e&&s.extend(i.prototype,e),n&&s.extend(i,n),i.prototype.constructor=i,i.__super__=t.prototype,i},M=function(t,e){return t&&t[e]?s.isFunction(t[e])?t[e]():t[e]:null},S=function(){throw Error('A "url" property or function must be specified')}}.call(this),n("backbone",["zepto","underscore"],function(t){return function(){var e;return e||t.Backbone}}(this)),Backbone.EventBinder=function(t,e){function n(t){return t.jquery?i.jquery:i["default"]}var i={"default":{bindTo:function(t,e,n,i){i=i||this,t.on(e,n,i);var r={type:"default",obj:t,eventName:e,callback:n,context:i};return r},unbindFrom:function(t){t.obj.off(t.eventName,t.callback,t.context)}},jquery:{bindTo:function(t,n,i,r){r=r||this,i=e(i).bind(r),t.on(n,i);var o={type:"jquery",obj:t,eventName:n,callback:i,context:r};return o},unbindFrom:function(t){t.obj.off(t.eventName,t.callback)}}},r=function(){this._eventBindings=[]};return r.extend=t.View.extend,e.extend(r.prototype,{bindTo:function(){var t=arguments[0],e=n(t),i=e.bindTo.apply(this,arguments);return this._eventBindings.push(i),i},unbindFrom:function(t){i[t.type].unbindFrom.apply(this,arguments),this._eventBindings=e.reject(this._eventBindings,function(e){return e===t})},unbindAll:function(){var t=e.map(this._eventBindings,e.identity);e.each(t,this.unbindFrom,this)}}),r}(Backbone,_),Backbone.Wreqr=function(t,e,n){"option strict";var i={};return i.Handlers=function(t,e){var n=function(){this._handlers={}};return n.extend=t.Model.extend,e.extend(n.prototype,{addHandler:function(t,e,n){var i={callback:e,context:n};this._handlers[t]=i},getHandler:function(t){var e=this._handlers[t];if(!e)throw Error("Handler not found for '"+t+"'");return function(){return e.callback.apply(e.context,arguments)}},removeHandler:function(t){delete this._handlers[t]},removeAllHandlers:function(){this._handlers={}}}),n}(t,n),i.Commands=function(t){return t.Handlers.extend({execute:function(t,e){this.getHandler(t)(e)}})}(i),i.RequestResponse=function(t){return t.Handlers.extend({request:function(t,e){return this.getHandler(t)(e)}})}(i),i.EventAggregator=function(t,e){var n=function(){};return n.extend=t.Model.extend,e.extend(n.prototype,t.Events),n}(t,n),i}(Backbone,Backbone.Marionette,_),Backbone.Marionette=Marionette=function(t,e,n){var i={},r=Array.prototype.slice;return i.extend=t.Model.extend,i.getOption=function(t,e){if(t&&e){var n;return n=t.options&&t.options[e]?t.options[e]:t[e]}},i.createObject=function(){function t(){}var e;return e="function"==typeof Object.create?Object.create:function(e){t.prototype=e;var n=new t;return t.prototype=null,n}}(),i.triggerMethod=function(){for(var t,n,i=Array.prototype.slice.apply(arguments),r=i[0],o=r.split(":"),s="on",a=0;o.length>a;a++)t=o[a],n=t.charAt(0).toUpperCase(),s+=n+t.slice(1);this.trigger.apply(this,arguments),e.isFunction(this[s])&&(i.shift(),this[s].apply(this,i))},i.EventBinder=t.EventBinder.extend({augment:function(t){var n=new i.EventBinder;t.eventBinder=n,t.bindTo=e.bind(n.bindTo,n),t.unbindFrom=e.bind(n.unbindFrom,n),t.unbindAll=e.bind(n.unbindAll,n)}}),i.addEventBinder=function(t){var n=new i.EventBinder;t.eventBinder=n,t.bindTo=e.bind(n.bindTo,n),t.unbindFrom=e.bind(n.unbindFrom,n),t.unbindAll=e.bind(n.unbindAll,n)},i.EventAggregator=t.Wreqr.EventAggregator.extend({constructor:function(){i.addEventBinder(this),t.Wreqr.EventAggregator.prototype.constructor.apply(this,arguments)}}),i.Callbacks=function(){this._deferred=n.Deferred(),this._callbacks=[]},e.extend(i.Callbacks.prototype,{add:function(t,e){this._callbacks.push({cb:t,ctx:e}),this._deferred.done(function(n,i){e&&(n=e),t.call(n,i)})},run:function(t,e){this._deferred.resolve(e,t)},reset:function(){var t=this,i=this._callbacks;this._deferred=n.Deferred(),this._callbacks=[],e.each(i,function(e){t.add(e.cb,e.ctx)})}}),i.TemplateCache=function(t){this.templateId=t},e.extend(i.TemplateCache,{templateCaches:{},get:function(t){var e=this.templateCaches[t];return e||(e=new i.TemplateCache(t),this.templateCaches[t]=e),e.load()},clear:function(){var t,e=arguments.length;if(e>0)for(t=0;e>t;t++)delete this.templateCaches[arguments[t]];else this.templateCaches={}}}),e.extend(i.TemplateCache.prototype,{load:function(){if(this.compiledTemplate)return this.compiledTemplate;var t=this.loadTemplate(this.templateId);return this.compiledTemplate=this.compileTemplate(t),this.compiledTemplate},loadTemplate:function(t){var e=n(t).html();if(!e||0===e.length){var i="Could not find template: '"+t+"'",r=Error(i);throw r.name="NoTemplateError",r}return e},compileTemplate:function(t){return e.template(t)}}),i.Renderer={render:function(t,e){var n="function"==typeof t?t:i.TemplateCache.get(t),r=n(e);return r}},i.Controller=function(t){this.options=t||{},i.addEventBinder(this),e.isFunction(this.initialize)&&this.initialize(t)},i.Controller.extend=i.extend,e.extend(i.Controller.prototype,t.Events),i.Region=function(t){if(this.options=t||{},i.addEventBinder(this),this.el=i.getOption(this,"el"),!this.el){var e=Error("An 'el' must be specified for a region.");throw e.name="NoElError",e}this.initialize&&this.initialize.apply(this,arguments)},e.extend(i.Region,{buildRegion:function(t,e){var n="string"==typeof t,i="string"==typeof t.selector,r=t.regionType===void 0,o="function"==typeof t;if(!o&&!n&&!i)throw Error("Region must be specified as a Region type, a selector string or an object with selector property");var s,a;n&&(s=t),t.selector&&(s=t.selector),o&&(a=t),!o&&r&&(a=e),t.regionType&&(a=t.regionType);var u=new a({el:s});return u}}),e.extend(i.Region.prototype,t.Events,{show:function(t){this.ensureEl(),this.close(),t.render(),this.open(t),i.triggerMethod.call(t,"show"),i.triggerMethod.call(this,"show",t),this.currentView=t},ensureEl:function(){this.$el&&0!==this.$el.length||(this.$el=this.getEl(this.el))},getEl:function(t){return n(t)},open:function(t){this.$el.empty().append(t.el)},close:function(){var t=this.currentView;t&&!t.isClosed&&(t.close&&t.close(),i.triggerMethod.call(this,"close"),delete this.currentView)},attachView:function(t){this.currentView=t},reset:function(){this.close(),delete this.$el}}),i.Region.extend=i.extend,i.View=t.View.extend({constructor:function(){e.bindAll(this,"render"),i.addEventBinder(this),t.View.prototype.constructor.apply(this,arguments),this.bindBackboneEntityTo(this.model,this.modelEvents),this.bindBackboneEntityTo(this.collection,this.collectionEvents),this.bindTo(this,"show",this.onShowCalled,this)},triggerMethod:i.triggerMethod,getTemplate:function(){return i.getOption(this,"template")},mixinTemplateHelpers:function(t){t=t||{};var n=this.templateHelpers;return e.isFunction(n)&&(n=n.call(this)),e.extend(t,n)},configureTriggers:function(){if(this.triggers){var t=this,n={},i=e.result(this,"triggers");return e.each(i,function(e,i){n[i]=function(n){n&&n.preventDefault&&n.preventDefault(),n&&n.stopPropagation&&n.stopPropagation(),t.trigger(e)}}),n}},delegateEvents:function(n){n=n||this.events,e.isFunction(n)&&(n=n.call(this));var i={},r=this.configureTriggers();e.extend(i,n,r),t.View.prototype.delegateEvents.call(this,i)},onShowCalled:function(){},close:function(){this.isClosed||(this.triggerMethod("before:close"),this.remove(),this.unbindAll(),this.triggerMethod("close"),this.isClosed=!0)},bindUIElements:function(){if(this.ui){var t=this;this.uiBindings||(this.uiBindings=this.ui),this.ui={},e.each(e.keys(this.uiBindings),function(e){var n=t.uiBindings[e];t.ui[e]=t.$(n)})}},bindBackboneEntityTo:function(t,n){if(t&&n){var i=this;e.each(n,function(e,n){var r=i[e];if(!r)throw Error("View method '"+e+"' was configured as an event handler, but does not exist.");i.bindTo(t,n,r,i)})}}}),i.ItemView=i.View.extend({constructor:function(){i.View.prototype.constructor.apply(this,arguments),this.initialEvents&&this.initialEvents()},serializeData:function(){var t={};return this.model?t=this.model.toJSON():this.collection&&(t={items:this.collection.toJSON()}),t},render:function(){this.isClosed=!1,this.triggerMethod("before:render",this),this.triggerMethod("item:before:render",this);var t=this.serializeData();t=this.mixinTemplateHelpers(t);var e=this.getTemplate(),n=i.Renderer.render(e,t);return this.$el.html(n),this.bindUIElements(),this.triggerMethod("render",this),this.triggerMethod("item:rendered",this),this},close:function(){this.isClosed||(this.triggerMethod("item:before:close"),i.View.prototype.close.apply(this,arguments),this.triggerMethod("item:closed"))}}),i.CollectionView=i.View.extend({constructor:function(t){this.initChildViewStorage(),i.View.prototype.constructor.apply(this,arguments),this.initialEvents(),this.onShowCallbacks=new i.Callbacks,t&&t.itemViewOptions&&(this.itemViewOptions=t.itemViewOptions)},initialEvents:function(){this.collection&&(this.bindTo(this.collection,"add",this.addChildView,this),this.bindTo(this.collection,"remove",this.removeItemView,this),this.bindTo(this.collection,"reset",this.render,this))},addChildView:function(t,e,n){this.closeEmptyView();
var i,r=this.getItemView(t);return i=n&&n.index?n.index:0,this.addItemView(t,r,i)},onShowCalled:function(){this.onShowCallbacks.run()},triggerBeforeRender:function(){this.triggerMethod("before:render",this),this.triggerMethod("collection:before:render",this)},triggerRendered:function(){this.triggerMethod("render",this),this.triggerMethod("collection:rendered",this)},render:function(){return this.isClosed=!1,this.triggerBeforeRender(),this.closeEmptyView(),this.closeChildren(),this.collection&&this.collection.length>0?this.showCollection():this.showEmptyView(),this.triggerRendered(),this},showCollection:function(){var t,e=this;this.collection.each(function(n,i){t=e.getItemView(n),e.addItemView(n,t,i)})},showEmptyView:function(){var e=i.getOption(this,"emptyView");if(e&&!this._showingEmptyView){this._showingEmptyView=!0;var n=new t.Model;this.addItemView(n,e,0)}},closeEmptyView:function(){this._showingEmptyView&&(this.closeChildren(),delete this._showingEmptyView)},getItemView:function(){var t=i.getOption(this,"itemView");if(!t){var e=Error("An `itemView` must be specified");throw e.name="NoItemViewError",e}return t},addItemView:function(t,n,i){var o,s=this;o=e.isFunction(this.itemViewOptions)?this.itemViewOptions(t):this.itemViewOptions;var a=this.buildItemView(t,n,o);this.storeChild(t,a),this.triggerMethod("item:added",a);var u=this.bindTo(a,"all",function(){var t=r.call(arguments);t[0]="itemview:"+t[0],t.splice(1,0,a),s.triggerMethod.apply(s,t)});this.childBindings=this.childBindings||{},this.childBindings[a.cid]=u;var c=this.renderItemView(a,i);return a.onShow&&this.onShowCallbacks.add(a.onShow,a),c},renderItemView:function(t,e){t.render(),this.appendHtml(this,t,e)},buildItemView:function(t,n,i){var r=e.extend({model:t},i),o=new n(r);return o},removeItemView:function(t){var e=this.children[t.cid];if(e){var n=this.childBindings[e.cid];n&&(this.unbindFrom(n),delete this.childBindings[e.cid]),e.close(),delete this.children[t.cid]}this.collection&&0!==this.collection.length||this.showEmptyView(),this.triggerMethod("item:removed",e)},appendHtml:function(t,e){t.$el.append(e.el)},storeChild:function(t,e){this.children[t.cid]=e},initChildViewStorage:function(){this.children={}},close:function(){this.isClosed||(this.triggerMethod("collection:before:close"),this.closeChildren(),this.triggerMethod("collection:closed"),i.View.prototype.close.apply(this,arguments))},closeChildren:function(){var t=this;this.children&&e.each(e.clone(this.children),function(e){t.removeItemView(e.model)})}}),i.CompositeView=i.CollectionView.extend({constructor:function(){i.CollectionView.apply(this,arguments),this.itemView=this.getItemView()},initialEvents:function(){this.collection&&(this.bindTo(this.collection,"add",this.addChildView,this),this.bindTo(this.collection,"remove",this.removeItemView,this),this.bindTo(this.collection,"reset",this.renderCollection,this))},getItemView:function(){var t=i.getOption(this,"itemView")||this.constructor;if(!t){var e=Error("An `itemView` must be specified");throw e.name="NoItemViewError",e}return t},serializeData:function(){var t={};return this.model&&(t=this.model.toJSON()),t},render:function(){this.isClosed=!1,this.resetItemViewContainer();var t=this.renderModel();return this.$el.html(t),this.bindUIElements(),this.triggerMethod("composite:model:rendered"),this.renderCollection(),this.triggerMethod("composite:rendered"),this},renderCollection:function(){i.CollectionView.prototype.render.apply(this,arguments),this.triggerMethod("composite:collection:rendered")},renderModel:function(){var t={};t=this.serializeData(),t=this.mixinTemplateHelpers(t);var e=this.getTemplate();return i.Renderer.render(e,t)},appendHtml:function(t,e){var n=this.getItemViewContainer(t);n.append(e.el)},getItemViewContainer:function(t){if("$itemViewContainer"in t)return t.$itemViewContainer;var n;if(t.itemViewContainer){var i=e.result(t,"itemViewContainer");if(n=t.$(i),0>=n.length){var r=Error("The specified `itemViewContainer` was not found: "+t.itemViewContainer);throw r.name="ItemViewContainerMissingError",r}}else n=t.$el;return t.$itemViewContainer=n,n},resetItemViewContainer:function(){this.$itemViewContainer&&delete this.$itemViewContainer}}),i.Layout=i.ItemView.extend({regionType:i.Region,constructor:function(){this._firstRender=!0,this.initializeRegions(),t.Marionette.ItemView.apply(this,arguments)},render:function(){this._firstRender?this._firstRender=!1:(this.closeRegions(),this.reInitializeRegions());var t=i.ItemView.prototype.render.apply(this,arguments);return t},close:function(){this.isClosed||(this.closeRegions(),this.destroyRegions(),t.Marionette.ItemView.prototype.close.call(this,arguments))},initializeRegions:function(){this.regionManagers||(this.regionManagers={});var t=this,n=this.regions||{};e.each(n,function(e,n){var r=i.Region.buildRegion(e,t.regionType);r.getEl=function(e){return t.$(e)},t.regionManagers[n]=r,t[n]=r})},reInitializeRegions:function(){this.regionManagers&&0===e.size(this.regionManagers)?this.initializeRegions():e.each(this.regionManagers,function(t){t.reset()})},closeRegions:function(){e.each(this.regionManagers,function(t){t.close()})},destroyRegions:function(){var t=this;e.each(this.regionManagers,function(e,n){delete t[n]}),this.regionManagers={}}}),i.AppRouter=t.Router.extend({constructor:function(e){if(t.Router.prototype.constructor.call(this,e),this.appRoutes){var n=this.controller;e&&e.controller&&(n=e.controller),this.processAppRoutes(n,this.appRoutes)}},processAppRoutes:function(t,n){var i,r,o,s,a,u=[],c=this;for(o in n)n.hasOwnProperty(o)&&u.unshift([o,n[o]]);for(s=u.length,a=0;s>a;a++){if(o=u[a][0],r=u[a][1],i=t[r],!i){var l="Method '"+r+"' was not found on the controller",h=Error(l);throw h.name="NoMethodError",h}i=e.bind(i,t),c.route(o,r,i)}}}),i.Application=function(n){this.initCallbacks=new i.Callbacks,this.vent=new i.EventAggregator,this.commands=new t.Wreqr.Commands,this.reqres=new t.Wreqr.RequestResponse,this.submodules={},e.extend(this,n),i.addEventBinder(this),this.triggerMethod=i.triggerMethod},e.extend(i.Application.prototype,t.Events,{execute:function(){this.commands.execute.apply(this.commands,arguments)},request:function(){return this.reqres.request.apply(this.reqres,arguments)},addInitializer:function(t){this.initCallbacks.add(t)},start:function(t){this.triggerMethod("initialize:before",t),this.initCallbacks.run(t,this),this.triggerMethod("initialize:after",t),this.triggerMethod("start",t)},addRegions:function(t){var n=this;e.each(t,function(t,e){var r=i.Region.buildRegion(t,i.Region);n[e]=r})},removeRegion:function(t){this[t].close(),delete this[t]},module:function(){var t=r.call(arguments);return t.unshift(this),i.Module.create.apply(i.Module,t)}}),i.Application.extend=i.extend,i.Module=function(t,e){this.moduleName=t,this.submodules={},this._setupInitializersAndFinalizers(),this.config={},this.config.app=e,i.addEventBinder(this)},e.extend(i.Module.prototype,t.Events,{addInitializer:function(t){this._initializerCallbacks.add(t)},addFinalizer:function(t){this._finalizerCallbacks.add(t)},start:function(t){this._isInitialized||(e.each(this.submodules,function(e){e.config.options.startWithParent&&e.start(t)}),this._initializerCallbacks.run(t,this),this._isInitialized=!0)},stop:function(){this._isInitialized&&(this._isInitialized=!1,e.each(this.submodules,function(t){t.stop()}),this._finalizerCallbacks.run(),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset())},addDefinition:function(t,e){this._runModuleDefinition(t,e)},_runModuleDefinition:function(r,o){if(r){var s=e.flatten([this,this.config.app,t,i,n,e,o]);r.apply(this,s)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new i.Callbacks,this._finalizerCallbacks=new i.Callbacks}}),e.extend(i.Module,{create:function(t,n,i){var o=this,s=t;n=n.split(".");var a=r.apply(arguments);a.splice(0,3);var u=n.length;return e.each(n,function(e,n){var r=n===u-1,c=o._getModuleDefinition(s,e,t);c.config.options=o._getModuleOptions(s,i),r&&o._configureAutoStart(t,c),r&&c.config.options.hasDefinition&&c.addDefinition(c.config.options.definition,a),s=c}),s},_configureAutoStart:function(t,e){e.config.options.startWithParent&&!e.config.autoStartConfigured&&t.addInitializer(function(t){e.start(t)}),e.config.autoStartConfigured=!0},_getModuleDefinition:function(t,e,n){var r=t[e];return r||(r=new i.Module(e,n),t[e]=r,t.submodules[e]=r),r},_getModuleOptions:function(t,n){var i={startWithParent:!0,hasDefinition:!!n};return i.hasDefinition?(e.isFunction(n)?i.definition=n:(i.hasDefinition=!!n.define,i.definition=n.define,n.hasOwnProperty("startWithParent")&&(i.startWithParent=n.startWithParent)),i):i}}),i}(Backbone,_,$||window.jQuery||window.Zepto||window.ender),n("marionette",["backbone"],function(t){return function(){var e;return e||t.Marionette}}(this)),n("Trak",[],function(){var t={event:function(){var t=_(arguments).toArray();t.unshift("_trackEvent"),_gaq.push(t)},customVar:function(){var t=_(arguments).toArray();t.unshift("_setCustomVar"),_gaq.push(t)},view:function(t){_gaq.push(["_trackPageview",t])}};if(ENV.DEV===!0)for(var e in t)t.hasOwnProperty(e)&&"function"==typeof t[e]&&(t[e]=function(){console.log("TRAK : ",arguments)});return t}),n("core/controllers/audio",[],function(){function t(t){return new Media(t,e,n,i)}function e(){console.log("media success")}function n(t){console.log("media fail",t)}function i(t){console.log("media status",t)}var r={audioBasePath:"audio/",extension:"mp3",currentStream:null,setAudioExtension:function(t){this.extension=t},prepare:function(e,n,i){if(window.Media){this.currentStream&&!i&&this.currentStream.stop();var r=this.getAudioFile(e,n);return this.currentStream=t(r),this.currentStream}return null},play:function(t,e,n){var i=this.prepare(t,e,n);i&&i.play()},getAudioFile:function(t,e){var n=this.getTypePath(t);return n+"/"+e+"."+this.extension},getTypePath:function(t){return this.audioBasePath+t}};return r}),n("core/games/selection/Item",["marionette","underscore","application","core/controllers/audio"],function(t,e,n,i){var r=t.ItemView.extend({tagName:"div",className:"pickable-item game",template:e.template('<div class="pickable"> <% if (image) {%><img src="<%=image%>"><% } else { %><span><%= id %></span><% } %> </div>'),isTarget:!1,audioController:i,constructor:function(){t.ItemView.prototype.constructor.apply(this,arguments),this._bindEvents()},_bindEvents:function(){this.$el.on("click",e(this.close).bind(this)),this.$el.on("mousedown",".pickable",e(this._onPress).bind(this)),this.$el.on("touchstart",".pickable",e(this._onPress).bind(this)),this.$el.on("mouseup",".pickable",e(this._onSelect).bind(this)),this.$el.on("touchend",".pickable",e(this._onSelect).bind(this))},_onPress:function(){this.$el.addClass("pressed")},_onSelect:function(){this.trigger("pickable:click",this),this.$el.unbind().removeClass("pressed"),this.isTarget?this.trigger("pickable:targetClick",this):this.$el.addClass("targetMissed transparent")},_hide:function(){this.$el.hide()},success:function(){return this.el.style.position="absolute",e.isFunction(this.onSuccess)&&this.onSuccess(),this},_fullscreen:function(){return this.$el.addClass("fullscreen"),this},askQuestion:function(){var t=this.model.get("type"),n=this.model.get(t);return n=e.isString(n)?n.toLowerCase():n,e.isFunction(this.onQuestion)&&this.onQuestion(t,n),this}});return r}),n("core/games/selection/List",["marionette","core/games/selection/Item","core/controllers/audio"],function(t,e,n){var i=t.CollectionView.extend({tagName:"div",className:"pickable-list",itemView:e,items:[],maxItems:6,audioController:n,constructor:function(){t.CompositeView.prototype.constructor.apply(this,arguments),this.on("item:added",this._bindItem,this),this.on("render",this._onRender,this),this.on("close",this._unbindEvents,this),this._spliceCollection()},_bindItem:function(t){this.bindTo(t,"pickable:targetClick",this._onTargetFound,this),this.bindTo(t,"pickable:click",this._onChildClick,this)},_spliceCollection:function(){var t=_.isFunction(this.items)?this.items():this.items;t=_.shuffle(t).splice(0,this.maxItems),this.collection=new Backbone.Collection(t)},_onRender:function(){this.targetIndex=~~(Math.random()*this.collection.length);var t=this.children[this.collection.at(this.targetIndex).cid];t.isTarget=!0,t.askQuestion()},_onChildClick:function(t){t.isTarget||this._onFailSelect()},_onTargetFound:function(t){_(this.children).each(function(e){e!==t&&e._hide()}),t._fullscreen().success(),_.isFunction(this.onSuccessSelect)&&this.onSuccessSelect()},_unbindEvents:function(){this.unbindAll()},_onFailSelect:function(){_.isFunction(this.onFailSelect)&&this.onFailSelect()},getRandomFailureSound:function(){var t=["hmm","uhoh","whoops"],e=~~(Math.random()*t.length);return t[e]}});return i}),n("games/alphabet/item",["application","core/games/selection/Item"],function(t,e){var n=e.extend({onQuestion:function(t,e){this.audioController.play(t,e)}});return n}),n("games/alphabet/List",["application","underscore","core/games/selection/List","games/alphabet/item"],function(t,n,i,r){var o=i.extend({itemView:r,items:function(){var t=[],e=65;return n(26).times(function(n){var i=String.fromCharCode(e+n);t.push({type:"letter",id:i,letter:i,image:""})}),t},onSuccessSelect:function(){this.audioController.play("success","applause"),e("application").vent.trigger("game:completed")},onFailSelect:function(){this.audioController.play("failure",this.getRandomFailureSound())}});return o}),n("games/definitions",["games/alphabet/List"],function(t){var e={games:[t],getRandom:function(){return this.games[~~(Math.random()*this.games.length)]}};return e}),n("core/rewards/selection/Item",["marionette","underscore","core/controllers/audio"],function(t,e,n){var i=t.ItemView.extend({tagName:"div",className:"pickable-item reward",template:e.template("<div class='pickable'></div>"),audioController:n,constructor:function(){t.ItemView.prototype.constructor.apply(this,arguments),this._bindEvents()},_bindEvents:function(){this.$el.on("click",e(this.close).bind(this)),this.$el.on("mousedown",".pickable",e(this._onPress).bind(this)),this.$el.on("touchstart",".pickable",e(this._onPress).bind(this)),this.$el.on("mouseup",".pickable",e(this._onSelect).bind(this)),this.$el.on("touchend",".pickable",e(this._onSelect).bind(this))},_onPress:function(){this.$el.addClass("pressed")},_onSelect:function(){this.trigger("pickable:click",this),this.$el.unbind().removeClass("pressed"),this.onSelect&&e.isFunction(this.onSelect)&&this.onSelect()},_hide:function(){this.$el.hide()}});return i}),n("core/rewards/selection/List",["marionette","core/rewards/selection/Item"],function(t,n){var i=t.CollectionView.extend({tagName:"div",className:"pickable-list",itemView:n,items:[],maxItems:6,constructor:function(){t.CompositeView.prototype.constructor.apply(this,arguments),this.on("item:added",this._bindItem,this),this.on("render",this.onRender,this),this.on("close",this._unbindEvents,this),this._spliceCollection()},_bindItem:function(t){this.bindTo(t,"pickable:click",this._onChildClick,this),this.bindTo(t,"reward:complete",this._onRewardComplete,this)},_spliceCollection:function(){var t=_.isFunction(this.items)?this.items():this.items;t=_.shuffle(t).splice(0,this.maxItems),this.collection=new Backbone.Collection(t)},_onChildClick:function(t){t.model.set("picked",!0);var e=this.collection.filter(function(t){return t.get("picked")===!1});0===e.length&&this._onRewardComplete()},_onRewardComplete:function(){setTimeout(function(){e("application").vent.trigger("game:new")},200)},_unbindEvents:function(){this.unbindAll()}});return i}),n("rewards/balloon/item",["application","core/rewards/selection/Item"],function(t,e){var n=e.extend({template:_.template("<div class='pickable'> <canvas></canvas> </div>"),onRender:function(){var t=document.getElementById("balloon-greyscale");this.canvas=this.$("canvas")[0],this.canvas.width=this.canvas.height=200,this.context=this.canvas.getContext("2d"),this.context.fillStyle="hsl("+this.model.get("hue")+",100%,50%)",this.context.fillRect(0,0,200,200),this.context.globalCompositeOperation="darker",this.context.drawImage(t,0,0,200,200)},onSelect:function(){this.audioController.play("action","pop");var t=document.getElementById("cloud");this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.drawImage(t,0,0,200,200),this.$el.addClass("transparent")}});return n}),n("rewards/balloon/List",["application","underscore","core/rewards/selection/List","rewards/balloon/item"],function(t,e,n,i){var r=n.extend({itemView:i,items:function(){var t=[];return e(50).times(function(){t.push({type:"balloon",hue:~~(255*Math.random()),picked:!1})}),t}});return r}),n("views/Timer",["marionette","underscore"],function(t,e){var n="#ff0000",i="#aed8ed",r=t.ItemView.extend({timer:10,countUp:0,angleStart:0,angleEnd:0,template:e.template('<canvas id="timer" width="100" height="100"></canvas><span id="count"></span></div>'),ui:{count:"#count"},initialize:function(){this.options.timer&&(this.timer=this.options.timer),this.currentCount=this.timer},onRender:function(){this.canvas=this.$("#timer")[0],this.context=this.canvas.getContext("2d"),this._renderCanvas(),this._renderLoop()},_updateAngleStart:function(){this.angleStart=this.angleEnd},_updateCounter:function(){5>=this.currentCount?(this.ui.count.css("color",n),this.context.strokeStyle=n):this.context.strokeStyle=i,this.ui.count.text(this.currentCount)},_handleCallback:function(){this.options.callback&&e.isFunction(this.options.callback)&&this.options.callback(),clearInterval(this._countDownInterval),this.close()},_step:function(){this.angleEnd=Math.PI*(2*this.countUp/this.timer),this.currentCount=this.timer-this.countUp},_renderCanvas:function(){this.context.lineWidth=7,this.context.lineCap="square",this.context.beginPath(),this.context.arc(50,50,30,this.angleStart,this.angleEnd,!1),this.context.stroke(),this._updateAngleStart(),this._updateCounter(),++this.countUp>this.timer+1&&this._handleCallback()},_renderLoop:function(){this._step(),this._renderCanvas(),this._countDownInterval||(this._countDownInterval=setInterval(e.bind(this._renderLoop,this),1e3))}});return r}),n("core/rewards/canvas/Item",["marionette","underscore","core/controllers/audio","views/Timer"],function(t,n,i,r){var o=t.ItemView.extend({audioController:i,timer:10,paused:!1,template:n.template('<canvas id="main"></canvas><div class="timer"></div>'),constructor:function(){t.ItemView.prototype.constructor.apply(this,arguments),this.on("render",this._onRender,this),this.on("close",this._onClose,this),this.on("render:loop",this._renderLoop,this)},contextClear:function(){this.context.fillStyle="#000",this.context.fillRect(0,0,this.canvas.width,this.canvas.height)},_startTimer:function(){var t=new r({timer:this.timer,callback:function(){e("application").vent.trigger("reward:completed")}});this.$(".timer").html(t.render().el)},_onClose:function(){this.contextClear()},_onRender:function(){this.canvas=this.$("canvas#main")[0],this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.context=this.canvas.getContext("2d"),this._bindEvents(),this._startTimer(),this.step&&this._renderLoop()},_bindEvents:function(){window.addEventListener("resize",this._windowResizeHandler,!1),window.addEventListener("orientationchange",this._windowResizeHandler,!1),this.canvas.addEventListener("mousemove",n.bind(this._onMouseMove,this),!1),this.canvas.addEventListener("mousedown",n.bind(this._onMouseToggle,this),!1),this.canvas.addEventListener("mouseup",n.bind(this._onMouseToggle,this),!1),this.canvas.addEventListener("touchstart",n.bind(this._onTouchStart,this),!1),this.canvas.addEventListener("touchmove",n.bind(this._onTouchMove,this),!1),window.addEventListener("keydown",n.bind(function(t){switch(t.which){case 32:this._pauseContext();break;case 83:this._displayStep();break;case 27:this.contextClear()}},this))},_onMouseMove:function(t){this.onMouseMove&&this.onMouseMove(t)},_onTouchStart:function(t){this.onTouchStart&&this.onTouchStart(t)},_onMouseToggle:function(t){this.onMouseToggle&&this.onMouseToggle(t)},_onTouchMove:function(t){this.onTouchMove&&this.onTouchMove(t)},_windowResizeHandler:function(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.onWindowResize&&this.onWindowResize()},_pauseContext:function(){this.paused^=!0},_displayStep:function(){this.step()},_renderCanvas:function(){this.renderCanvas&&this.renderCanvas()},_renderLoop:function(){this.paused||this.step(),requestAnimationFrame(n.bind(this._renderLoop,this)),this._renderCanvas()}});return o}),n("rewards/bubbles/main",["application","core/rewards/canvas/Item"],function(t,e){var n=0,i=0,r=2*Math.PI,o=50,s=e.extend({timer:10,shakeCallback:function(){this.contextClear()},getRandomColor:function(){return"#"+Math.floor(16777215*Math.random()).toString(16)},onWindowResize:function(){this.draw()},onRender:function(){this.audioController.play("action","draw")},draw:function(t,e){var n=this.getRandomColor();this.context.globalCompositeOperation="source-over",this.context.beginPath(),this.context.fillStyle=n,this.context.arc(t,e,1+Math.random()*o,0,r,!1),this.context.closePath(),this.context.fill()},updateMouse:function(t){n=t.pageX-t.target.offsetLeft,i=t.pageY-t.target.offsetTop,this.draw(n,i)},onMouseMove:function(t){this.updateMouse(t)},onTouchStart:function(t){this.updateTouches(t.changedTouches)},onTouchMove:function(t){this.updateTouches(t.changedTouches)},updateTouches:function(t){for(var e=0;t.length>e;e++)this.draw(t[e].pageX,t[e].pageY)}});return s}),n("rewards/definitions",["rewards/balloon/List","rewards/bubbles/main"],function(t,e){var n={rewards:[t,e],getRandom:function(){return this.rewards[~~(Math.random()*this.rewards.length)]}};return n}),n("views/MainMenu",["marionette","underscore"],function(t,n){var i=t.ItemView.extend({tagName:"div",id:"main-menu",template:n.template('<div><button class="start btn btn-large btn-info">Start!</button</div>'),events:{"click .start":"onStartClick","mousedown .start":"onSelect","touchstart .start":"onSelect","mouseup .start":"onStartClick","touchend .start":"onStartClick"},onStartClick:function(){e("application").newGame()},onUnselect:function(){},onSelect:function(){}});return i}),n("animations/fireworks/util",[],function(){return{length:function(t){return Math.abs(Math.sqrt(t[0]*t[0]+t[1]*t[1]))},fromAngle:function(t,e){return[e*Math.cos(t),e*Math.sin(t)]},getAngle:function(t){var e=0,n=0,i=t[0],r=t[1];i>0?r>0?(n=0,e=r/i):(n=3*Math.PI/2,e=i/r):r>0?(n=Math.PI/2,e=i/r):(n=Math.PI,e=r/i);var o=Math.atan(Math.abs(e))+n;return o},getAngleDegrees:function(t){return 180*t/Math.PI}}}),n("animations/fireworks/Particle",["animations/fireworks/util"],function(){var t=function(t){this.pos=t,this.expired=!1,this.acc=[0,0],this.gravity=[0,.01],this.ttl=~~(40*Math.random())+10};return t.prototype.launch=function(t){return this.vel=t||[0,0],this},t.prototype.update=function(){return this.expired?this:(this.acc[0]+=this.gravity[0],this.acc[1]+=this.gravity[1],this.vel[0]+=this.acc[0],this.vel[1]+=this.acc[1],this.pos[0]+=this.vel[0],this.pos[1]+=this.vel[1],0>=--this.ttl&&(this.expired=!0),this)},t}),n("animations/fireworks/Firework",["animations/fireworks/Particle","animations/fireworks/util"],function(t,e){function n(t,e){this.pos=t,this.hue=e,this.exploded=!1,this.power=5,this.explosionSize=50,this.particles=[],this.gravity=[0,.01],this.size=4,this.halfSize=~~(this.size/2),this.onExplode=function(){},this.ttl=void 0}return n.prototype.launch=function(t,e){return this.vel=t||[0,0],this.acc=e||[0,0],this},n.prototype.update=function(){if(this.exploded){this.cleanupParticles();for(var t=0,e=this.particles.length;e>t;t++)!this.particles[t].expired&&this.particles[t].update()}else this.acc[0]+=this.gravity[0],this.acc[1]+=this.gravity[1],this.vel[0]+=this.acc[0],this.vel[1]+=this.acc[1],this.pos[0]+=this.vel[0],this.pos[1]+=this.vel[1],void 0!==this.ttl&&1>Math.abs(this.vel[1])&&(this.ttl=~~(20*Math.random())),0>=--this.ttl&&this.explode();return this},n.prototype.render=function(t){if(t.fillStyle="hsl("+this.hue+",100%,50%)",this.exploded){for(var e=0,n=this.particles.length;n>e;e++)if(!this.particles[e].expired){var i=this.particles[e];t.fillRect(i.pos[0]-2,i.pos[1]-2,4,4)}}else t.fillRect(this.pos[0]-this.halfSize,this.pos[1]-this.halfSize,this.size,this.size)},n.prototype.explode=function(){if(this.exploded)return this;this.onExplode(),this.exploded=!0;for(var n,i=(this.power,this.explosionSize);i--;)n=e.fromAngle(2*(i/this.explosionSize)*Math.PI,this.power*(100-80*Math.random())/100),this.particles.push(new t([this.pos[0],this.pos[1]]).launch(n))},n.prototype.cleanupParticles=function(){for(var t=this.particles.length,e=0;t--;)this.particles[t].expired&&++e;this.expired=this.particles.length===e&&this.exploded},n}),n("animations/fireworks/Fireworks",["animations/fireworks/Firework"],function(t){function e(t){function e(){n(),i()?requestAnimFrame(e):(s.fillStyle="black",s.fillRect(0,0,t.width,t.height),r.animating=!1)}function n(){s.fillStyle="rgba(0,0,0,.3)",s.fillRect(0,0,t.width,t.height)}function i(){for(var t=o.length,e=0;t--;){var n=o[t];n.expired?e++:n.update().render(s)}return o.length>e}var r=this,o=this.fireworks=[],s=t.getContext("2d");r.animate=function(){r.animating||(r.animating=!0,e())}}return e.prototype.launch=function(e){var n=new t(e.pos,e.hue);n.onExplode=e.onExplode,n.launch(e.vel),this.fireworks.push(n),this.animate()},e}),n("animations/starburst/Starburst",[],function(){function t(t){function e(){o.width=t.width,o.height=t.height,c=[.5*o.width,.5*o.height],i.clear(),i.render(),i.isStopping&&0>--i.ttl&&(i.animating=!1),i.animating?requestAnimFrame(e):i.clear()}var n=t.getContext("2d"),i=this,r={hue:~~(255*Math.random()),saturation:100,lightness:50,alpha:0},o={width:t.width,height:t.height},s=2*Math.PI/360,a=2*Math.PI,u=s/60,c=[.5*o.width,.5*o.height],l=Math.sqrt(o.width*o.width+o.height*o.height),h=20;i.getBackgroundColor=function(){return"rgb(0,0,0)"},i.getForegroundColor=function(){var t=r;return i.isStopping?t.alpha=i.ttl/i.totalTtl:1>t.alpha&&(t.alpha+=.01),t.alpha>1?"hsl("+t.hue+","+t.saturation+"%,"+t.lightness+"%)":"hsla("+t.hue+","+t.saturation+"%,"+t.lightness+"%,"+t.alpha+")"},i.animate=function(){i.animating||(i.animating=!0,e())},i.clear=function(){n.fillStyle=i.getBackgroundColor(),n.fillRect(0,0,o.width,o.height)},i.stop=function(){i.isStopping=!0,i.ttl=i.totalTtl=50};var d=0;i.render=function(){n.fillStyle=i.getForegroundColor(),n.beginPath();var t,e,r=2*h,o=1.5*l;n.moveTo(c[0],c[1]);for(var s=0;h>s;s++)d+=u,t=d+2*s/r*a,e=d+(2*s+1)/r*a,n.lineTo(o*Math.cos(t),o*Math.sin(t)),n.lineTo(o*Math.cos(e),o*Math.sin(e)),n.lineTo(c[0],c[1]);n.fill()},i.animate()}return t}),n("animations",["zepto","animations/fireworks/Fireworks","animations/starburst/Starburst","core/controllers/audio"],function(t,e,n,i){function r(){o.width=window.innerWidth,o.height=window.innerHeight}var o,s;return t(function(){o=document.getElementById("canvas"),s=o.getContext("2d"),r(),t(window).on("resize orientationchange",r)}),{starburst:function(){var t=new n(o);setTimeout(t.stop,4e3)},fireworks:function(){for(var t=new e(o),n=7;n--;)setTimeout(function(){t.launch({pos:[window.innerWidth/2,window.innerHeight],vel:[6*Math.random()-3,-(5*Math.random())-12],hue:255*Math.random(),onExplode:function(){i.play("action","firework",!0)}})},1e3*2*Math.random())}}}),n("views/AnimationMenu",["zepto","marionette","underscore","animations"],function(t,e,n,i){var r=e.ItemView.extend({tagName:"div",id:"animation-menu",events:{"mousedown .animation":"onSelect","touchstart .animation":"onSelect","mouseup .animation":"onUnselect","touchend .animation":"onUnselect"},render:function(){var e=this;n(i).each(function(n,i){e.$el.append(t("<button>").addClass("animation").data("anim",i).text(i))})},onUnselect:function(e){var n=t(e.target);i[n.data("anim")]()},onSelect:function(){}});return r}),n("application",["marionette","underscore","Trak","games/definitions","rewards/definitions","views/MainMenu","views/AnimationMenu","animations"],function(t,e,n,i,r,o,s,a){function u(t){h.newGameTimer=setTimeout(function(){h.vent.trigger("game:new")},t)}function c(){var t;t=Math.random()>.5?a.fireworks:a.starburst,setTimeout(t,500)}function l(t){var e=t.indexOf(":"),i=t.substring(0,e),r=t.substring(e+1,t.length);h.vent.on(t,function(){n.event(i,r)})}var h=new t.Application;h.addRegions({main:"#content"});var d=0;return h.newGame=function(){clearTimeout(h.newGameTimer),n.event("game","new");var t;t=0===++d%5?r.getRandom():i.getRandom(),h.main.show(new t)},h.mainMenu=function(){h.main.show(new o)},h.animationMenu=function(){h.main.show(new s)},h.resume=function(){h.mainMenu()},h.vent.on("app:start",function(){h.mainMenu()}),h.vent.on("game:new",h.newGame),h.vent.on("reward:completed",function(){u(800)}),h.vent.on("game:completed",function(){c(),u(6500)}),["game:completed","game:new","app:start","app:resume","reward:completed","pickable:click","pickable:targetClick"].forEach(l),h}),n("trak",[],function(){var t={event:function(){var t=_(arguments).toArray();t.unshift("_trackEvent"),_gaq.push(t)},customVar:function(){var t=_(arguments).toArray();t.unshift("_setCustomVar"),_gaq.push(t)},view:function(t){_gaq.push(["_trackPageview",t])}};if(ENV.DEV===!0)for(var e in t)t.hasOwnProperty(e)&&"function"==typeof t[e]&&(t[e]=function(){console.log("TRAK : ",arguments)});return t}),n("VERSION",[],function(){return{major:0,minor:6,patch:0,toString:function(){return[this.major,this.minor,this.patch].join(".")}}}),e.config({locale:"en_US",paths:{zepto:"vendor/zepto",underscore:"vendor/underscore",backbone:"vendor/backbone",marionette:"vendor/backbone.marionette",deferred:"vendor/deferred",cordova:"vendor/cordova-2.2.0"},shim:{underscore:{exports:"_"},backbone:{deps:["zepto","underscore"],exports:"Backbone"},marionette:{deps:["backbone"],exports:"Marionette"},deferred:{deps:["underscore"],exports:"Deferred"},zepto:{deps:["deferred"],exports:"$",init:function(t){return t.installInto(this.$),this.$}}}}),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),e(["zepto","application","trak","VERSION"],function(t,e,n,i){function r(){setTimeout(o,100)}function o(){cordova.exec(null,null,"SplashScreen","hide",[])}t(document).on("touchmove touchstart touchend",function(t){t.preventDefault()}),t(function(){n.view("alphabet-"+(""+i)),e.vent.trigger("app:start"),document.addEventListener("deviceready",r,!1),document.addEventListener("resume",e.resume,!1)})}),n("main",function(){})})();